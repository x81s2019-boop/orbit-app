<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Orbit - 時間管理應用</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Meta Tags -->
    <meta name="description" content="Orbit - 智能時間管理應用，幫助您管理任務、養成習慣、追蹤目標">
    <meta name="keywords" content="時間管理, 任務管理, 習慣養成, 目標追蹤, 番茄鐘, GTD">
    <meta name="author" content="Orbit Dev Team">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#8B4513">
    <meta name="msapplication-TileColor" content="#8B4513">
    
    <!-- iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Orbit">
    
    <!-- iOS Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="144x144" href="icons/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="120x120" href="icons/icon-128x128.png">
    
    <!-- Standard Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-72x72.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/icon-72x72.png">
    
    <!-- Android Chrome -->
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Microsoft -->
    <meta name="msapplication-TileImage" content="icons/icon-144x144.png">
    
    <!-- External Resources -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, sans-serif;
            background: 
                linear-gradient(135deg, #f5ebe0 0%, #ede0d4 50%, #e8d5c4 100%);
            padding: 40px 20px;
            min-height: 100vh;
            position: relative;
        }

        /* 木紋紋理背景 */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(90deg, 
                    transparent, 
                    transparent 2px, 
                    rgba(139, 115, 85, 0.02) 2px, 
                    rgba(139, 115, 85, 0.02) 4px),
                radial-gradient(circle at 30% 20%, rgba(210, 180, 140, 0.1), transparent 60%),
                radial-gradient(circle at 70% 80%, rgba(188, 143, 143, 0.1), transparent 60%);
            pointer-events: none;
            z-index: 0;
        }

        /* 添加細膩的光影效果 */
        body::after {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at center, 
                transparent 0%, 
                rgba(255, 248, 240, 0.3) 50%, 
                transparent 100%);
            animation: subtleRotate 30s linear infinite;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes subtleRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .page-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .page-header h1 {
            font-size: 36px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #5d4e37;
            letter-spacing: 1px;
            text-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.1),
                0 1px 0 rgba(255, 255, 255, 0.8);
        }

        .page-header p {
            font-size: 14px;
            color: #8b7355;
            font-weight: 400;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
        }

        .screens-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(390px, 1fr));
            gap: 60px;
            justify-items: center;
        }

        .screen-wrapper {
            width: 390px;
        }

        .screen-label {
            text-align: center;
            color: #5d4e37;
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 16px;
            padding: 10px 20px;
            background: 
                linear-gradient(135deg, 
                    #f0dcc8 0%, 
                    #e6ccb2 50%, 
                    #dcc2a8 100%);
            border-radius: 12px;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.1),
                0 4px 8px rgba(93, 78, 55, 0.08),
                inset 0 1px 2px rgba(255, 255, 255, 0.4),
                inset 0 -1px 2px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
        }

        /* 標籤紋理 */
        .screen-label::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 1px,
                    rgba(255, 255, 255, 0.05) 1px,
                    rgba(255, 255, 255, 0.05) 2px);
            border-radius: 12px;
            pointer-events: none;
        }

        /* iPhone框架 - 精緻木質邊框 */
        .iphone-frame {
            width: 390px;
            height: 844px;
            background: 
                linear-gradient(135deg, 
                    #9d8568 0%, 
                    #8b7355 25%, 
                    #7a6545 50%, 
                    #6b5d4f 75%, 
                    #5d4e37 100%);
            border-radius: 50px;
            padding: 12px;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.1),
                0 4px 8px rgba(93, 78, 55, 0.15),
                0 8px 16px rgba(93, 78, 55, 0.2),
                0 16px 32px rgba(93, 78, 55, 0.25),
                inset 0 2px 4px rgba(255, 255, 255, 0.15),
                inset 0 -2px 4px rgba(0, 0, 0, 0.15);
            position: relative;
        }

        /* 木紋效果 */
        .iphone-frame::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 50px;
            background-image: 
                repeating-linear-gradient(90deg,
                    transparent,
                    transparent 3px,
                    rgba(0, 0, 0, 0.03) 3px,
                    rgba(0, 0, 0, 0.03) 6px),
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 1px,
                    rgba(0, 0, 0, 0.01) 1px,
                    rgba(0, 0, 0, 0.01) 2px);
            pointer-events: none;
        }

        /* 細膩的高光 */
        .iphone-frame::after {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 40%;
            background: linear-gradient(180deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                transparent 100%);
            border-radius: 50px 50px 0 0;
            pointer-events: none;
        }

        .phone-container {
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(135deg, #fdfbf7 0%, #faf8f5 50%, #f7f5f2 100%);
            border-radius: 40px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.8);
        }

        /* 紙質紋理 */
        .phone-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 2px,
                    rgba(139, 115, 85, 0.008) 2px,
                    rgba(139, 115, 85, 0.008) 4px),
                repeating-linear-gradient(90deg,
                    transparent,
                    transparent 2px,
                    rgba(139, 115, 85, 0.008) 2px,
                    rgba(139, 115, 85, 0.008) 4px);
            pointer-events: none;
            z-index: 1;
        }

        /* iOS狀態欄 - 精緻質感 */
        .status-bar {
            height: 44px;
            background: 
                linear-gradient(180deg, 
                    rgba(255, 255, 255, 0.98) 0%, 
                    rgba(250, 248, 245, 0.95) 100%);
            backdrop-filter: blur(20px) saturate(180%);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 24px;
            font-size: 15px;
            color: #3a3a3c;
            font-weight: 500;
            border-bottom: 1px solid rgba(139, 115, 85, 0.08);
            box-shadow: 0 1px 3px rgba(93, 78, 55, 0.05);
            position: relative;
            z-index: 10;
        }

        .status-left {
            font-size: 15px;
            font-weight: 600;
        }

        .status-right {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        /* 主要內容區 */
        .content {
            height: calc(100% - 44px - 83px);
            overflow-y: auto;
            background: #faf8f5;
            padding: 20px;
        }

        /* 問候語 */
        .greeting {
            margin-bottom: 24px;
        }

        .greeting h2 {
            font-size: 28px;
            font-weight: 600;
            color: #5d4e37;
            margin-bottom: 4px;
        }

        .greeting p {
            font-size: 15px;
            color: #8b7355;
        }

        /* 統計卡片 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: 
                linear-gradient(135deg, 
                    #e8d4b8 0%, 
                    #ddb892 50%, 
                    #c9a882 100%);
            padding: 20px;
            border-radius: 16px;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.1),
                0 2px 4px rgba(93, 78, 55, 0.12),
                0 4px 8px rgba(93, 78, 55, 0.14),
                0 8px 16px rgba(93, 78, 55, 0.16),
                inset 0 1px 2px rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.4);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.12),
                0 4px 8px rgba(93, 78, 55, 0.14),
                0 8px 16px rgba(93, 78, 55, 0.16),
                0 12px 24px rgba(93, 78, 55, 0.18);
        }

        /* 精緻的光暈效果 */
        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, 
                rgba(255, 255, 255, 0.25), 
                rgba(255, 255, 255, 0.1) 50%, 
                transparent);
            border-radius: 50%;
        }

        /* 細膩的紙質紋理 */
        .stat-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 1px,
                    rgba(255, 255, 255, 0.03) 1px,
                    rgba(255, 255, 255, 0.03) 2px);
            pointer-events: none;
        }

        .stat-icon {
            width: 44px;
            height: 44px;
            background: 
                linear-gradient(135deg, 
                    rgba(255, 255, 255, 0.5) 0%, 
                    rgba(255, 255, 255, 0.3) 50%, 
                    rgba(255, 255, 255, 0.2) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            margin-bottom: 12px;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.1),
                inset 0 1px 2px rgba(255, 255, 255, 0.6),
                inset 0 -1px 2px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.5);
            position: relative;
            z-index: 1;
        }

        .stat-value {
            font-size: 26px;
            font-weight: 700;
            color: #3a3a3c;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 13px;
            color: rgba(58, 58, 60, 0.7);
            font-weight: 500;
        }

        /* 區塊標題 */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #5d4e37;
        }

        .section-action {
            font-size: 14px;
            color: #a07855;
            text-decoration: none;
            font-weight: 500;
        }

        /* 任務卡片 - 精緻紙質質感 */
        .task-card {
            background: 
                linear-gradient(135deg, 
                    #ffffff 0%, 
                    #fefefe 50%, 
                    #fcfcfc 100%);
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 12px;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.06),
                0 2px 4px rgba(93, 78, 55, 0.08),
                0 4px 8px rgba(93, 78, 55, 0.1),
                inset 0 1px 1px rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: flex-start;
            gap: 12px;
            border: 1px solid rgba(139, 115, 85, 0.08);
            position: relative;
            transition: all 0.3s ease;
        }

        .task-card:hover {
            transform: translateY(-1px);
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.08),
                0 4px 8px rgba(93, 78, 55, 0.1),
                0 6px 12px rgba(93, 78, 55, 0.12);
        }

        /* 紙質紋理 */
        .task-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 2px,
                    rgba(139, 115, 85, 0.01) 2px,
                    rgba(139, 115, 85, 0.01) 4px);
            border-radius: 12px;
            pointer-events: none;
        }

        .task-checkbox {
            width: 22px;
            height: 22px;
            border: 2px solid #ddb892;
            border-radius: 6px;
            flex-shrink: 0;
            margin-top: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 1px 3px rgba(93, 78, 55, 0.1),
                inset 0 1px 2px rgba(255, 255, 255, 0.5);
            background: 
                linear-gradient(135deg, 
                    #fefefe 0%, 
                    #fcfcfc 100%);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .task-checkbox:hover {
            transform: scale(1.1);
            border-color: #c9a882;
        }

        .task-checkbox.checked {
            background: 
                linear-gradient(135deg, 
                    #b89068 0%, 
                    #a07855 50%, 
                    #8b6f47 100%);
            border-color: #a07855;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.2),
                inset 0 1px 2px rgba(255, 255, 255, 0.2),
                inset 0 -1px 2px rgba(0, 0, 0, 0.15);
        }

        .task-checkbox.checked::after {
            content: '✓';
            color: white;
            font-size: 14px;
            font-weight: 700;
        }

        .task-content {
            flex: 1;
        }

        .task-title {
            font-size: 15px;
            color: #3a3a3c;
            margin-bottom: 4px;
            font-weight: 500;
        }

        .task-time {
            font-size: 13px;
            color: #8b7355;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .task-priority {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            flex-shrink: 0;
            margin-top: 6px;
        }

        .priority-high {
            background: #d4a574; /* 深木色 - 高優先級 */
        }

        .priority-medium {
            background: #e6ccb2; /* 淺木色 - 中優先級 */
        }
        
        .priority-low {
            background: #b8dbd9; /* 淡綠色 - 低優先級 */
        }

        /* 進度區塊 - 精緻卡片質感 */
        .progress-section {
            background: 
                linear-gradient(135deg, 
                    #ffffff 0%, 
                    #fefefe 50%, 
                    #fcfcfc 100%);
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 24px;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.06),
                0 2px 4px rgba(93, 78, 55, 0.08),
                0 4px 8px rgba(93, 78, 55, 0.1),
                inset 0 1px 1px rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(139, 115, 85, 0.08);
            position: relative;
        }

        .progress-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 2px,
                    rgba(139, 115, 85, 0.01) 2px,
                    rgba(139, 115, 85, 0.01) 4px);
            border-radius: 16px;
            pointer-events: none;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .progress-title {
            font-size: 16px;
            font-weight: 600;
            color: #5d4e37;
        }

        .progress-percentage {
            font-size: 18px;
            font-weight: 700;
            color: #a07855;
        }

        .progress-bar-bg {
            height: 8px;
            background: 
                linear-gradient(180deg, 
                    #ede3d5 0%, 
                    #f5ebe0 50%, 
                    #faf0e6 100%);
            border-radius: 4px;
            overflow: hidden;
            box-shadow: 
                inset 0 1px 3px rgba(93, 78, 55, 0.15),
                inset 0 -1px 1px rgba(255, 255, 255, 0.5);
        }

        .progress-bar-fill {
            height: 100%;
            background: 
                linear-gradient(90deg, 
                    #e8d4b8 0%, 
                    #ddb892 25%, 
                    #d4ad89 50%, 
                    #c9a882 75%, 
                    #bf9f7a 100%);
            border-radius: 4px;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                inset 0 -1px 0 rgba(0, 0, 0, 0.1);
            position: relative;
        }

        /* 進度條光澤效果 */
        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(180deg, 
                rgba(255, 255, 255, 0.3) 0%, 
                transparent 100%);
            border-radius: 4px 4px 0 0;
        }

        /* 週計劃 */
        .week-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-bottom: 24px;
        }

        .day-cell {
            background: 
                linear-gradient(135deg, 
                    #ffffff 0%, 
                    #fefefe 50%, 
                    #fcfcfc 100%);
            padding: 12px 8px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.06),
                0 2px 4px rgba(93, 78, 55, 0.08),
                inset 0 1px 1px rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(139, 115, 85, 0.08);
            transition: all 0.3s ease;
        }

        .day-cell:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.1),
                0 4px 8px rgba(93, 78, 55, 0.12);
        }

        .day-cell.today {
            background: 
                linear-gradient(135deg, 
                    #e8d4b8 0%, 
                    #ddb892 50%, 
                    #c9a882 100%);
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.15),
                0 4px 8px rgba(93, 78, 55, 0.12),
                inset 0 1px 2px rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .day-cell.selected {
            background: 
                linear-gradient(135deg, 
                    #d4a574 0%, 
                    #c9a882 50%, 
                    #b8967a 100%);
            box-shadow: 
                0 2px 6px rgba(93, 78, 55, 0.2),
                0 4px 12px rgba(93, 78, 55, 0.15),
                inset 0 1px 2px rgba(255, 255, 255, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
        }
        
        .day-cell.selected .day-name,
        .day-cell.selected .day-number {
            color: #ffffff;
        }
        
        .day-cell.selected .day-dot {
            background: #ffffff;
        }
        
        .day-cell {
            cursor: pointer;
        }

        .day-name {
            font-size: 11px;
            color: #8b7355;
            margin-bottom: 4px;
            font-weight: 500;
        }

        .day-cell.today .day-name {
            color: rgba(58, 58, 60, 0.7);
        }

        .day-number {
            font-size: 16px;
            font-weight: 600;
            color: #3a3a3c;
        }

        .day-dots {
            display: flex;
            gap: 2px;
            justify-content: center;
            margin-top: 4px;
        }

        .day-dot {
            width: 4px;
            height: 4px;
            background: #ddb892;
            border-radius: 50%;
        }

        /* 習慣追蹤 - 精緻卡片 */
        .habit-item {
            background: 
                linear-gradient(135deg, 
                    #ffffff 0%, 
                    #fefefe 50%, 
                    #fcfcfc 100%);
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 12px;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.06),
                0 2px 4px rgba(93, 78, 55, 0.08),
                0 4px 8px rgba(93, 78, 55, 0.1),
                inset 0 1px 1px rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(139, 115, 85, 0.08);
            position: relative;
            transition: all 0.3s ease;
        }

        .habit-item:hover {
            transform: translateY(-1px);
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.08),
                0 4px 8px rgba(93, 78, 55, 0.1),
                0 6px 12px rgba(93, 78, 55, 0.12);
        }

        .habit-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 2px,
                    rgba(139, 115, 85, 0.01) 2px,
                    rgba(139, 115, 85, 0.01) 4px);
            border-radius: 12px;
            pointer-events: none;
        }

        .habit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .habit-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .habit-icon {
            width: 40px;
            height: 40px;
            background: 
                linear-gradient(135deg, 
                    #e8d4b8 0%, 
                    #ddb892 50%, 
                    #c9a882 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.15),
                inset 0 1px 2px rgba(255, 255, 255, 0.4),
                inset 0 -1px 2px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .habit-name {
            font-size: 15px;
            font-weight: 600;
            color: #3a3a3c;
            margin-bottom: 2px;
        }

        .habit-streak {
            font-size: 12px;
            color: #8b7355;
        }

        .habit-check {
            width: 28px;
            height: 28px;
            border: 2px solid #ddb892;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 
                0 1px 3px rgba(93, 78, 55, 0.1),
                inset 0 1px 2px rgba(255, 255, 255, 0.5);
            background: 
                linear-gradient(135deg, 
                    #fefefe 0%, 
                    #fcfcfc 100%);
            transition: all 0.3s ease;
        }

        .habit-check:hover {
            transform: scale(1.1);
            border-color: #c9a882;
        }

        .habit-check.checked {
            background: 
                linear-gradient(135deg, 
                    #b89068 0%, 
                    #a07855 50%, 
                    #8b6f47 100%);
            border-color: #a07855;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.2),
                inset 0 1px 2px rgba(255, 255, 255, 0.2),
                inset 0 -1px 2px rgba(0, 0, 0, 0.15);
        }

        .habit-check.checked::after {
            content: '✓';
            color: white;
            font-size: 16px;
            font-weight: 700;
        }

        .habit-week {
            display: flex;
            gap: 6px;
        }

        .habit-day {
            width: 30px;
            height: 30px;
            background: 
                linear-gradient(135deg, 
                    #faf0e6 0%, 
                    #f5ebe0 50%, 
                    #f0e6dc 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            color: #8b7355;
            font-weight: 600;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.08),
                inset 0 1px 1px rgba(255, 255, 255, 0.6);
            border: 1px solid rgba(139, 115, 85, 0.1);
            transition: all 0.3s ease;
        }

        .habit-day:hover {
            transform: scale(1.1);
        }

        .habit-day.completed {
            background: 
                linear-gradient(135deg, 
                    #e8d4b8 0%, 
                    #ddb892 50%, 
                    #c9a882 100%);
            color: #3a3a3c;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.15),
                inset 0 1px 2px rgba(255, 255, 255, 0.3),
                inset 0 -1px 2px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* 月曆 */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-title {
            font-size: 20px;
            font-weight: 600;
            color: #5d4e37;
        }

        .calendar-nav {
            display: flex;
            gap: 12px;
        }

        .nav-btn {
            width: 32px;
            height: 32px;
            background: 
                linear-gradient(135deg, 
                    #f0dcc8 0%, 
                    #e6ccb2 50%, 
                    #dcc2a8 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #5d4e37;
            cursor: pointer;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.12),
                inset 0 1px 2px rgba(255, 255, 255, 0.4),
                inset 0 -1px 2px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            transform: scale(1.05);
            box-shadow: 
                0 3px 6px rgba(93, 78, 55, 0.15),
                inset 0 1px 2px rgba(255, 255, 255, 0.5);
        }

        .nav-btn:active {
            transform: scale(0.95);
        }

        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-bottom: 8px;
        }

        .weekday {
            text-align: center;
            font-size: 12px;
            color: #8b7355;
            font-weight: 600;
            padding: 8px 0;
        }

        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }

        .calendar-day {
            aspect-ratio: 1;
            background: 
                linear-gradient(135deg, 
                    #ffffff 0%, 
                    #fefefe 50%, 
                    #fcfcfc 100%);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #3a3a3c;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.05),
                0 2px 4px rgba(93, 78, 55, 0.06),
                inset 0 1px 1px rgba(255, 255, 255, 0.8);
            position: relative;
            border: 1px solid rgba(139, 115, 85, 0.06);
            transition: all 0.3s ease;
        }

        .calendar-day:hover {
            transform: scale(1.05);
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.08),
                0 4px 8px rgba(93, 78, 55, 0.1);
        }

        .calendar-day.today {
            background: 
                linear-gradient(135deg, 
                    #e8d4b8 0%, 
                    #ddb892 50%, 
                    #c9a882 100%);
            font-weight: 700;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.15),
                0 4px 8px rgba(93, 78, 55, 0.12),
                inset 0 1px 2px rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .calendar-day.selected {
            background: 
                linear-gradient(135deg, 
                    #d4a574 0%, 
                    #c9a882 50%, 
                    #b8967a 100%);
            color: #ffffff;
            font-weight: 700;
            box-shadow: 
                0 2px 6px rgba(93, 78, 55, 0.2),
                0 4px 12px rgba(93, 78, 55, 0.18),
                inset 0 1px 2px rgba(255, 255, 255, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.6);
            transform: scale(1.08);
        }

        .calendar-day.has-events::after {
            content: '';
            width: 4px;
            height: 4px;
            background: #a07855;
            border-radius: 50%;
            position: absolute;
            bottom: 4px;
        }

        .calendar-day.other-month {
            opacity: 0.3;
        }

        /* 年度目標 - 精緻卡片 */
        .goal-card {
            background: 
                linear-gradient(135deg, 
                    #ffffff 0%, 
                    #fefefe 50%, 
                    #fcfcfc 100%);
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 16px;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.06),
                0 2px 4px rgba(93, 78, 55, 0.08),
                0 4px 8px rgba(93, 78, 55, 0.1),
                inset 0 1px 1px rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(139, 115, 85, 0.08);
            position: relative;
            transition: all 0.3s ease;
        }

        .goal-card:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.08),
                0 4px 8px rgba(93, 78, 55, 0.1),
                0 8px 16px rgba(93, 78, 55, 0.12);
        }

        .goal-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 2px,
                    rgba(139, 115, 85, 0.01) 2px,
                    rgba(139, 115, 85, 0.01) 4px);
            border-radius: 16px;
            pointer-events: none;
        }

        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .goal-title {
            font-size: 16px;
            font-weight: 600;
            color: #5d4e37;
            margin-bottom: 4px;
        }

        .goal-category {
            font-size: 12px;
            color: #8b7355;
            background: 
                linear-gradient(135deg, 
                    #faf0e6 0%, 
                    #f5ebe0 50%, 
                    #f0e6dc 100%);
            padding: 4px 10px;
            border-radius: 6px;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.08),
                inset 0 1px 1px rgba(255, 255, 255, 0.6);
            border: 1px solid rgba(139, 115, 85, 0.12);
        }

        .goal-progress {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .goal-progress-bar {
            flex: 1;
            height: 6px;
            background: #f5ebe0;
            border-radius: 3px;
            overflow: hidden;
        }

        .goal-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ddb892 0%, #c9a882 100%);
            border-radius: 3px;
        }

        .goal-progress-text {
            font-size: 13px;
            font-weight: 600;
            color: #a07855;
        }

        /* 專注計時器 - 精緻質感 */
        .focus-timer {
            background: 
                linear-gradient(135deg, 
                    #e8d4b8 0%, 
                    #ddb892 25%, 
                    #d4ad89 50%, 
                    #c9a882 75%, 
                    #bf9f7a 100%);
            padding: 40px 20px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 24px;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.12),
                0 4px 8px rgba(93, 78, 55, 0.15),
                0 8px 16px rgba(93, 78, 55, 0.18),
                0 12px 24px rgba(93, 78, 55, 0.2),
                inset 0 2px 4px rgba(255, 255, 255, 0.25),
                inset 0 -2px 4px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
        }

        /* 紙質紋理 */
        .focus-timer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 2px,
                    rgba(255, 255, 255, 0.03) 2px,
                    rgba(255, 255, 255, 0.03) 4px);
            border-radius: 20px;
            pointer-events: none;
        }

        /* 頂部光暈 */
        .focus-timer::after {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 50%;
            background: linear-gradient(180deg, 
                rgba(255, 255, 255, 0.2) 0%, 
                transparent 100%);
            border-radius: 20px 20px 0 0;
            pointer-events: none;
        }

        .timer-display {
            font-size: 56px;
            font-weight: 700;
            color: #3a3a3c;
            margin-bottom: 16px;
            letter-spacing: 2px;
        }

        .timer-label {
            font-size: 14px;
            color: rgba(58, 58, 60, 0.7);
            margin-bottom: 24px;
            font-weight: 500;
        }

        .timer-controls {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .timer-btn {
            padding: 12px 24px;
            background: 
                linear-gradient(135deg, 
                    #ffffff 0%, 
                    #fefefe 50%, 
                    #fcfcfc 100%);
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            color: #5d4e37;
            cursor: pointer;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.15),
                0 4px 8px rgba(93, 78, 55, 0.1),
                inset 0 1px 2px rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(139, 115, 85, 0.15);
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }

        .timer-btn:hover {
            transform: translateY(-1px);
            box-shadow: 
                0 4px 8px rgba(93, 78, 55, 0.18),
                0 6px 12px rgba(93, 78, 55, 0.12);
        }

        .timer-btn.primary {
            background: 
                linear-gradient(135deg, 
                    #9d8568 0%, 
                    #8b7355 50%, 
                    #7a6545 100%);
            color: white;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.2),
                0 4px 8px rgba(93, 78, 55, 0.15),
                inset 0 1px 2px rgba(255, 255, 255, 0.2),
                inset 0 -1px 2px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .timer-btn.primary:hover {
            background: 
                linear-gradient(135deg, 
                    #a89376 0%, 
                    #9d8568 50%, 
                    #8b7355 100%);
        }

        /* 設定項目 */
        .settings-section {
            margin-bottom: 24px;
        }

        .settings-section-title {
            font-size: 13px;
            color: #8b7355;
            font-weight: 600;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .setting-item {
            background: 
                linear-gradient(135deg, 
                    #ffffff 0%, 
                    #fefefe 50%, 
                    #fcfcfc 100%);
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.06),
                0 2px 4px rgba(93, 78, 55, 0.08),
                inset 0 1px 1px rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(139, 115, 85, 0.08);
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .setting-item:hover {
            transform: translateX(4px);
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.1),
                0 4px 8px rgba(93, 78, 55, 0.12);
        }

        .setting-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 2px,
                    rgba(139, 115, 85, 0.01) 2px,
                    rgba(139, 115, 85, 0.01) 4px);
            border-radius: 12px;
            pointer-events: none;
        }

        .setting-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .setting-icon {
            width: 36px;
            height: 36px;
            background: 
                linear-gradient(135deg, 
                    #e8d4b8 0%, 
                    #ddb892 50%, 
                    #c9a882 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #3a3a3c;
            font-size: 16px;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.15),
                inset 0 1px 2px rgba(255, 255, 255, 0.4),
                inset 0 -1px 2px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .setting-text {
            font-size: 15px;
            color: #3a3a3c;
            font-weight: 500;
        }

        .setting-arrow {
            color: #8b7355;
            font-size: 14px;
        }

        /* 底部標籤欄 - 精緻質感 */
        .tab-bar {
            height: 83px;
            background: 
                linear-gradient(180deg, 
                    rgba(250, 248, 245, 0.98) 0%, 
                    rgba(255, 255, 255, 0.95) 100%);
            backdrop-filter: blur(20px) saturate(180%);
            border-top: 1px solid rgba(139, 115, 85, 0.12);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding-bottom: 20px;
            box-shadow: 0 -2px 8px rgba(93, 78, 55, 0.06);
            position: relative;
        }

        /* 頂部細膩光澤 */
        .tab-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.6) 50%, 
                transparent 100%);
        }

        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            color: #8b7355;
            cursor: pointer;
        }

        .tab-item.active {
            color: #5d4e37;
        }

        .tab-icon {
            font-size: 24px;
        }

        .tab-label {
            font-size: 10px;
            font-weight: 600;
        }

        /* 總結圖表 */
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .summary-stat {
            background: 
                linear-gradient(135deg, 
                    #ffffff 0%, 
                    #fefefe 50%, 
                    #fcfcfc 100%);
            padding: 20px 12px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.06),
                0 2px 4px rgba(93, 78, 55, 0.08),
                0 4px 8px rgba(93, 78, 55, 0.1),
                inset 0 1px 1px rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(139, 115, 85, 0.08);
            position: relative;
            transition: all 0.3s ease;
        }

        .summary-stat:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.1),
                0 4px 8px rgba(93, 78, 55, 0.12),
                0 6px 12px rgba(93, 78, 55, 0.14);
        }

        .summary-stat::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 2px,
                    rgba(139, 115, 85, 0.01) 2px,
                    rgba(139, 115, 85, 0.01) 4px);
            border-radius: 12px;
            pointer-events: none;
        }

        .summary-value {
            font-size: 28px;
            font-weight: 700;
            color: #5d4e37;
            margin-bottom: 4px;
        }

        .summary-label {
            font-size: 12px;
            color: #8b7355;
        }

        .chart-card {
            background: 
                linear-gradient(135deg, 
                    #ffffff 0%, 
                    #fefefe 50%, 
                    #fcfcfc 100%);
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 16px;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.06),
                0 2px 4px rgba(93, 78, 55, 0.08),
                0 4px 8px rgba(93, 78, 55, 0.1),
                inset 0 1px 1px rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(139, 115, 85, 0.08);
            position: relative;
        }

        .chart-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 2px,
                    rgba(139, 115, 85, 0.01) 2px,
                    rgba(139, 115, 85, 0.01) 4px);
            border-radius: 16px;
            pointer-events: none;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: #5d4e37;
            margin-bottom: 16px;
        }

        .chart-bars {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            height: 120px;
            gap: 8px;
        }

        .chart-bar {
            flex: 1;
            background: 
                linear-gradient(180deg, 
                    #e8d4b8 0%, 
                    #ddb892 30%, 
                    #d4ad89 60%, 
                    #c9a882 100%);
            border-radius: 6px 6px 0 0;
            position: relative;
            box-shadow: 
                0 2px 4px rgba(93, 78, 55, 0.15),
                inset 1px 0 0 rgba(255, 255, 255, 0.3),
                inset -1px 0 0 rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(139, 115, 85, 0.2);
            border-bottom: none;
        }

        /* 柱狀圖頂部光澤 */
        .chart-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 30%;
            background: linear-gradient(180deg, 
                rgba(255, 255, 255, 0.3) 0%, 
                transparent 100%);
            border-radius: 6px 6px 0 0;
        }

        .chart-label {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 11px;
            color: #8b7355;
            white-space: nowrap;
        }

        /* 成就徽章 */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .achievement-badge {
            background: 
                linear-gradient(135deg, 
                    #ffffff 0%, 
                    #fefefe 50%, 
                    #fcfcfc 100%);
            padding: 20px 12px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 
                0 1px 2px rgba(93, 78, 55, 0.06),
                0 2px 4px rgba(93, 78, 55, 0.08),
                0 4px 8px rgba(93, 78, 55, 0.1),
                inset 0 1px 1px rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(139, 115, 85, 0.08);
            position: relative;
            transition: all 0.3s ease;
        }

        .achievement-badge:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 
                0 4px 8px rgba(93, 78, 55, 0.12),
                0 8px 16px rgba(93, 78, 55, 0.15);
        }

        .achievement-badge::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 2px,
                    rgba(139, 115, 85, 0.01) 2px,
                    rgba(139, 115, 85, 0.01) 4px);
            border-radius: 16px;
            pointer-events: none;
        }

        .achievement-icon {
            font-size: 36px;
            margin-bottom: 8px;
        }

        .achievement-name {
            font-size: 12px;
            color: #5d4e37;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .achievement-desc {
            font-size: 10px;
            color: #8b7355;
        }

        /* 添加按鈕 */
        .fab {
            position: fixed;
            bottom: 100px;
            right: 20px;
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, #ddb892 0%, #c9a882 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            box-shadow: 0 4px 16px rgba(93, 78, 55, 0.3);
            cursor: pointer;
        }

        /* 模態對話框 */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(93, 78, 55, 0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #fdfbf7 0%, #faf8f5 100%);
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            box-shadow: 
                0 10px 40px rgba(93, 78, 55, 0.3),
                0 4px 8px rgba(93, 78, 55, 0.2);
            border: 1px solid rgba(139, 115, 85, 0.15);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: #5d4e37;
            margin-bottom: 20px;
            text-align: center;
        }

        .modal-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e6ccb2;
            border-radius: 10px;
            font-size: 15px;
            font-family: 'Noto Sans TC', sans-serif;
            margin-bottom: 16px;
            background: white;
            box-shadow: inset 0 1px 3px rgba(93, 78, 55, 0.1);
            transition: all 0.3s ease;
        }

        .modal-input:focus {
            outline: none;
            border-color: #ddb892;
            box-shadow: 0 0 0 3px rgba(221, 184, 146, 0.2);
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            font-family: 'Noto Sans TC', sans-serif;
            transition: all 0.3s ease;
        }

        .modal-btn-primary {
            background: linear-gradient(135deg, #e8d4b8 0%, #ddb892 50%, #c9a882 100%);
            color: #3a3a3c;
            box-shadow: 0 2px 8px rgba(93, 78, 55, 0.2);
        }

        .modal-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(93, 78, 55, 0.3);
        }

        .modal-btn-secondary {
            background: white;
            color: #8b7355;
            border: 2px solid #e6ccb2;
        }

        .modal-btn-secondary:hover {
            background: #f5ebe0;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 頁面標題 -->
        <div class="page-header">
            <h1>🌲 Orbit 時間管理</h1>
            <p>簡約 · 溫暖 · 木質調設計</p>
        </div>

        <!-- 所有畫面展示 -->
        <div class="screens-grid">
            
            <!-- 1. 首頁儀表板 -->
            <div class="screen-wrapper">
                <div class="screen-label">📊 首頁儀表板</div>
                <div class="iphone-frame">
                    <div class="phone-container">
                        <div class="status-bar">
                            <div class="status-left">9:41</div>
                            <div class="status-right">
                                <i class="fas fa-signal"></i>
                                <i class="fas fa-wifi"></i>
                                <i class="fas fa-battery-three-quarters"></i>
                            </div>
                        </div>
                        
                        <div class="content">
                            <div class="greeting">
                                <h2>早安，朋友 ☀️</h2>
                                <p>12月8日，星期一</p>
                            </div>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon">📋</div>
                                    <div class="stat-value">12</div>
                                    <div class="stat-label">今日任務</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">✅</div>
                                    <div class="stat-value">8</div>
                                    <div class="stat-label">已完成</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">🎯</div>
                                    <div class="stat-value">5</div>
                                    <div class="stat-label">本週目標</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">🔥</div>
                                    <div class="stat-value">15天</div>
                                    <div class="stat-label">連續打卡</div>
                                </div>
                            </div>
                            
                            <div class="progress-section">
                                <div class="progress-header">
                                    <div class="progress-title">今日進度</div>
                                    <div class="progress-percentage">67%</div>
                                </div>
                                <div class="progress-bar-bg">
                                    <div class="progress-bar-fill" style="width: 67%"></div>
                                </div>
                            </div>
                            
                            <div class="section-header">
                                <div class="section-title">即將到來</div>
                                <a href="#" class="section-action">查看全部</a>
                            </div>
                            
                            <div class="task-card">
                                <div class="task-checkbox"></div>
                                <div class="task-content">
                                    <div class="task-title">團隊會議</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 10:00 AM
                                    </div>
                                </div>
                                <div class="task-priority priority-high"></div>
                            </div>
                            
                            <div class="task-card">
                                <div class="task-checkbox checked"></div>
                                <div class="task-content">
                                    <div class="task-title">完成專案提案</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 2:00 PM
                                    </div>
                                </div>
                                <div class="task-priority priority-medium"></div>
                            </div>
                        </div>
                        
                        <div class="tab-bar">
                            <div class="tab-item active">
                                <div class="tab-icon"><i class="fas fa-home"></i></div>
                                <div class="tab-label">首頁</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="tab-label">待辦</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-calendar"></i></div>
                                <div class="tab-label">日曆</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-chart-line"></i></div>
                                <div class="tab-label">統計</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-cog"></i></div>
                                <div class="tab-label">設定</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 2. 每日待辦 -->
            <div class="screen-wrapper">
                <div class="screen-label">✅ 每日待辦</div>
                <div class="iphone-frame">
                    <div class="phone-container">
                        <div class="status-bar">
                            <div class="status-left">9:41</div>
                            <div class="status-right">
                                <i class="fas fa-signal"></i>
                                <i class="fas fa-wifi"></i>
                                <i class="fas fa-battery-three-quarters"></i>
                            </div>
                        </div>
                        
                        <div class="content">
                            <div class="greeting">
                                <h2>今日待辦 📝</h2>
                                <p>還有 4 個任務待完成</p>
                            </div>
                            
                            <div class="progress-section">
                                <div class="progress-header">
                                    <div class="progress-title">完成度</div>
                                    <div class="progress-percentage">67%</div>
                                </div>
                                <div class="progress-bar-bg">
                                    <div class="progress-bar-fill" style="width: 67%"></div>
                                </div>
                            </div>
                            
                            <div class="section-title" style="margin-bottom: 16px;">進行中</div>
                            
                            <div class="task-card">
                                <div class="task-checkbox"></div>
                                <div class="task-content">
                                    <div class="task-title">完成產品設計稿</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 上午 10:00
                                    </div>
                                </div>
                                <div class="task-priority priority-high"></div>
                            </div>
                            
                            <div class="task-card">
                                <div class="task-checkbox"></div>
                                <div class="task-content">
                                    <div class="task-title">回覆客戶郵件</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 下午 2:00
                                    </div>
                                </div>
                                <div class="task-priority priority-medium"></div>
                            </div>
                            
                            <div class="task-card">
                                <div class="task-checkbox"></div>
                                <div class="task-content">
                                    <div class="task-title">整理會議記錄</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 下午 4:00
                                    </div>
                                </div>
                                <div class="task-priority priority-medium"></div>
                            </div>
                            
                            <div class="section-title" style="margin: 24px 0 16px;">已完成</div>
                            
                            <div class="task-card" style="opacity: 0.6;">
                                <div class="task-checkbox checked"></div>
                                <div class="task-content">
                                    <div class="task-title" style="text-decoration: line-through;">晨間運動</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 上午 7:00
                                    </div>
                                </div>
                                <div class="task-priority priority-high"></div>
                            </div>
                            
                            <div class="task-card" style="opacity: 0.6;">
                                <div class="task-checkbox checked"></div>
                                <div class="task-content">
                                    <div class="task-title" style="text-decoration: line-through;">閱讀30分鐘</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 上午 8:00
                                    </div>
                                </div>
                                <div class="task-priority priority-medium"></div>
                            </div>
                        </div>
                        
                        <div class="tab-bar">
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-home"></i></div>
                                <div class="tab-label">首頁</div>
                            </div>
                            <div class="tab-item active">
                                <div class="tab-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="tab-label">待辦</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-calendar"></i></div>
                                <div class="tab-label">日曆</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-chart-line"></i></div>
                                <div class="tab-label">統計</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-cog"></i></div>
                                <div class="tab-label">設定</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 3. 週計劃 -->
            <div class="screen-wrapper">
                <div class="screen-label">📅 週計劃</div>
                <div class="iphone-frame">
                    <div class="phone-container">
                        <div class="status-bar">
                            <div class="status-left">9:41</div>
                            <div class="status-right">
                                <i class="fas fa-signal"></i>
                                <i class="fas fa-wifi"></i>
                                <i class="fas fa-battery-three-quarters"></i>
                            </div>
                        </div>
                        
                        <div class="content">
                            <div class="greeting">
                                <h2>本週計劃 📆</h2>
                                <p>12月 4日 - 12月 10日</p>
                            </div>
                            
                            <div class="week-grid">
                                <div class="day-cell">
                                    <div class="day-name">週日</div>
                                    <div class="day-number">4</div>
                                    <div class="day-dots">
                                        <div class="day-dot"></div>
                                        <div class="day-dot"></div>
                                    </div>
                                </div>
                                <div class="day-cell today">
                                    <div class="day-name">週一</div>
                                    <div class="day-number">5</div>
                                    <div class="day-dots">
                                        <div class="day-dot"></div>
                                        <div class="day-dot"></div>
                                        <div class="day-dot"></div>
                                    </div>
                                </div>
                                <div class="day-cell">
                                    <div class="day-name">週二</div>
                                    <div class="day-number">6</div>
                                    <div class="day-dots">
                                        <div class="day-dot"></div>
                                    </div>
                                </div>
                                <div class="day-cell">
                                    <div class="day-name">週三</div>
                                    <div class="day-number">7</div>
                                    <div class="day-dots">
                                        <div class="day-dot"></div>
                                        <div class="day-dot"></div>
                                    </div>
                                </div>
                                <div class="day-cell">
                                    <div class="day-name">週四</div>
                                    <div class="day-number">8</div>
                                </div>
                                <div class="day-cell">
                                    <div class="day-name">週五</div>
                                    <div class="day-number">9</div>
                                    <div class="day-dots">
                                        <div class="day-dot"></div>
                                    </div>
                                </div>
                                <div class="day-cell">
                                    <div class="day-name">週六</div>
                                    <div class="day-number">10</div>
                                </div>
                            </div>
                            
                            <div class="section-title" style="margin: 24px 0 16px;">本週任務</div>
                            
                            <div class="task-card">
                                <div class="task-checkbox"></div>
                                <div class="task-content">
                                    <div class="task-title">完成Q4季度報告</div>
                                    <div class="task-time">
                                        <i class="far fa-calendar"></i> 週五前完成
                                    </div>
                                </div>
                                <div class="task-priority priority-high"></div>
                            </div>
                            
                            <div class="task-card">
                                <div class="task-checkbox"></div>
                                <div class="task-content">
                                    <div class="task-title">準備產品發表會</div>
                                    <div class="task-time">
                                        <i class="far fa-calendar"></i> 週四前完成
                                    </div>
                                </div>
                                <div class="task-priority priority-high"></div>
                            </div>
                            
                            <div class="task-card">
                                <div class="task-checkbox checked"></div>
                                <div class="task-content">
                                    <div class="task-title">健身 3 次</div>
                                    <div class="task-time">
                                        <i class="far fa-calendar"></i> 進度 2/3
                                    </div>
                                </div>
                                <div class="task-priority priority-medium"></div>
                            </div>
                            
                            <div class="task-card">
                                <div class="task-checkbox"></div>
                                <div class="task-content">
                                    <div class="task-title">閱讀一本書</div>
                                    <div class="task-time">
                                        <i class="far fa-calendar"></i> 週末完成
                                    </div>
                                </div>
                                <div class="task-priority priority-medium"></div>
                            </div>
                        </div>
                        
                        <div class="tab-bar">
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-home"></i></div>
                                <div class="tab-label">首頁</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="tab-label">待辦</div>
                            </div>
                            <div class="tab-item active">
                                <div class="tab-icon"><i class="fas fa-calendar"></i></div>
                                <div class="tab-label">日曆</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-chart-line"></i></div>
                                <div class="tab-label">統計</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-cog"></i></div>
                                <div class="tab-label">設定</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 4. 月曆視圖 -->
            <div class="screen-wrapper">
                <div class="screen-label">📆 月曆視圖</div>
                <div class="iphone-frame">
                    <div class="phone-container">
                        <div class="status-bar">
                            <div class="status-left">9:41</div>
                            <div class="status-right">
                                <i class="fas fa-signal"></i>
                                <i class="fas fa-wifi"></i>
                                <i class="fas fa-battery-three-quarters"></i>
                            </div>
                        </div>
                        
                        <div class="content">
                            <div class="calendar-header">
                                <div class="calendar-title">2024年 12月</div>
                                <div class="calendar-nav">
                                    <div class="nav-btn"><i class="fas fa-chevron-left"></i></div>
                                    <div class="nav-btn"><i class="fas fa-chevron-right"></i></div>
                                </div>
                            </div>
                            
                            <div class="calendar-weekdays">
                                <div class="weekday">日</div>
                                <div class="weekday">一</div>
                                <div class="weekday">二</div>
                                <div class="weekday">三</div>
                                <div class="weekday">四</div>
                                <div class="weekday">五</div>
                                <div class="weekday">六</div>
                            </div>
                            
                            <div class="calendar-days">
                                <div class="calendar-day other-month">26</div>
                                <div class="calendar-day other-month">27</div>
                                <div class="calendar-day other-month">28</div>
                                <div class="calendar-day other-month">29</div>
                                <div class="calendar-day other-month">30</div>
                                <div class="calendar-day has-events">1</div>
                                <div class="calendar-day">2</div>
                                <div class="calendar-day">3</div>
                                <div class="calendar-day has-events">4</div>
                                <div class="calendar-day has-events">5</div>
                                <div class="calendar-day">6</div>
                                <div class="calendar-day">7</div>
                                <div class="calendar-day today has-events">8</div>
                                <div class="calendar-day">9</div>
                                <div class="calendar-day has-events">10</div>
                                <div class="calendar-day">11</div>
                                <div class="calendar-day">12</div>
                                <div class="calendar-day has-events">13</div>
                                <div class="calendar-day">14</div>
                                <div class="calendar-day has-events">15</div>
                                <div class="calendar-day">16</div>
                                <div class="calendar-day">17</div>
                                <div class="calendar-day">18</div>
                                <div class="calendar-day has-events">19</div>
                                <div class="calendar-day">20</div>
                                <div class="calendar-day">21</div>
                                <div class="calendar-day has-events">22</div>
                                <div class="calendar-day">23</div>
                                <div class="calendar-day">24</div>
                                <div class="calendar-day has-events">25</div>
                                <div class="calendar-day">26</div>
                                <div class="calendar-day">27</div>
                                <div class="calendar-day">28</div>
                                <div class="calendar-day">29</div>
                                <div class="calendar-day has-events">30</div>
                                <div class="calendar-day has-events">31</div>
                                <div class="calendar-day other-month">1</div>
                                <div class="calendar-day other-month">2</div>
                                <div class="calendar-day other-month">3</div>
                                <div class="calendar-day other-month">4</div>
                            </div>
                            
                            <div class="section-title" style="margin: 24px 0 16px;">今日活動</div>
                            
                            <div class="task-card">
                                <div class="task-checkbox"></div>
                                <div class="task-content">
                                    <div class="task-title">團隊例會</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 10:00 - 11:00
                                    </div>
                                </div>
                                <div class="task-priority priority-high"></div>
                            </div>
                            
                            <div class="task-card">
                                <div class="task-checkbox"></div>
                                <div class="task-content">
                                    <div class="task-title">客戶提案</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 14:00 - 15:30
                                    </div>
                                </div>
                                <div class="task-priority priority-high"></div>
                            </div>
                        </div>
                        
                        <div class="tab-bar">
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-home"></i></div>
                                <div class="tab-label">首頁</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="tab-label">待辦</div>
                            </div>
                            <div class="tab-item active">
                                <div class="tab-icon"><i class="fas fa-calendar"></i></div>
                                <div class="tab-label">日曆</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-chart-line"></i></div>
                                <div class="tab-label">統計</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-cog"></i></div>
                                <div class="tab-label">設定</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 5. 年度規劃 -->
            <div class="screen-wrapper">
                <div class="screen-label">🎯 年度規劃</div>
                <div class="iphone-frame">
                    <div class="phone-container">
                        <div class="status-bar">
                            <div class="status-left">9:41</div>
                            <div class="status-right">
                                <i class="fas fa-signal"></i>
                                <i class="fas fa-wifi"></i>
                                <i class="fas fa-battery-three-quarters"></i>
                            </div>
                        </div>
                        
                        <div class="content">
                            <div class="greeting">
                                <h2>2024 年度目標 🎯</h2>
                                <p>還有 24 天</p>
                            </div>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon">📝</div>
                                    <div class="stat-value">12</div>
                                    <div class="stat-label">年度目標</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">✨</div>
                                    <div class="stat-value">8</div>
                                    <div class="stat-label">已達成</div>
                                </div>
                            </div>
                            
                            <div class="section-title" style="margin: 24px 0 16px;">目標清單</div>
                            
                            <div class="goal-card">
                                <div class="goal-header">
                                    <div>
                                        <div class="goal-title">完成專業認證</div>
                                        <div class="goal-category">💼 職涯發展</div>
                                    </div>
                                </div>
                                <div class="goal-progress">
                                    <div class="goal-progress-bar">
                                        <div class="goal-progress-fill" style="width: 85%"></div>
                                    </div>
                                    <div class="goal-progress-text">85%</div>
                                </div>
                            </div>
                            
                            <div class="goal-card">
                                <div class="goal-header">
                                    <div>
                                        <div class="goal-title">閱讀 24 本書</div>
                                        <div class="goal-category">📚 個人成長</div>
                                    </div>
                                </div>
                                <div class="goal-progress">
                                    <div class="goal-progress-bar">
                                        <div class="goal-progress-fill" style="width: 75%"></div>
                                    </div>
                                    <div class="goal-progress-text">18/24</div>
                                </div>
                            </div>
                            
                            <div class="goal-card">
                                <div class="goal-header">
                                    <div>
                                        <div class="goal-title">減重 10 公斤</div>
                                        <div class="goal-category">💪 健康生活</div>
                                    </div>
                                </div>
                                <div class="goal-progress">
                                    <div class="goal-progress-bar">
                                        <div class="goal-progress-fill" style="width: 60%"></div>
                                    </div>
                                    <div class="goal-progress-text">6/10</div>
                                </div>
                            </div>
                            
                            <div class="goal-card">
                                <div class="goal-header">
                                    <div>
                                        <div class="goal-title">學會一門外語</div>
                                        <div class="goal-category">🌍 技能學習</div>
                                    </div>
                                </div>
                                <div class="goal-progress">
                                    <div class="goal-progress-bar">
                                        <div class="goal-progress-fill" style="width: 45%"></div>
                                    </div>
                                    <div class="goal-progress-text">45%</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-bar">
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-home"></i></div>
                                <div class="tab-label">首頁</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="tab-label">待辦</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-calendar"></i></div>
                                <div class="tab-label">日曆</div>
                            </div>
                            <div class="tab-item active">
                                <div class="tab-icon"><i class="fas fa-chart-line"></i></div>
                                <div class="tab-label">統計</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-cog"></i></div>
                                <div class="tab-label">設定</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 6. 年度總結 -->
            <div class="screen-wrapper">
                <div class="screen-label">📊 年度總結</div>
                <div class="iphone-frame">
                    <div class="phone-container">
                        <div class="status-bar">
                            <div class="status-left">9:41</div>
                            <div class="status-right">
                                <i class="fas fa-signal"></i>
                                <i class="fas fa-wifi"></i>
                                <i class="fas fa-battery-three-quarters"></i>
                            </div>
                        </div>
                        
                        <div class="content">
                            <div class="greeting">
                                <h2>2024 年度回顧 🎊</h2>
                                <p>你的精彩一年</p>
                            </div>
                            
                            <div class="summary-stats">
                                <div class="summary-stat">
                                    <div class="summary-value">365</div>
                                    <div class="summary-label">完成任務</div>
                                </div>
                                <div class="summary-stat">
                                    <div class="summary-value">89%</div>
                                    <div class="summary-label">目標達成率</div>
                                </div>
                                <div class="summary-stat">
                                    <div class="summary-value">1,250</div>
                                    <div class="summary-label">專注時數</div>
                                </div>
                            </div>
                            
                            <div class="chart-card">
                                <div class="chart-title">月度任務完成趨勢</div>
                                <div class="chart-bars">
                                    <div class="chart-bar" style="height: 60%;">
                                        <div class="chart-label">1月</div>
                                    </div>
                                    <div class="chart-bar" style="height: 75%;">
                                        <div class="chart-label">2月</div>
                                    </div>
                                    <div class="chart-bar" style="height: 85%;">
                                        <div class="chart-label">3月</div>
                                    </div>
                                    <div class="chart-bar" style="height: 70%;">
                                        <div class="chart-label">4月</div>
                                    </div>
                                    <div class="chart-bar" style="height: 90%;">
                                        <div class="chart-label">5月</div>
                                    </div>
                                    <div class="chart-bar" style="height: 95%;">
                                        <div class="chart-label">6月</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="section-title" style="margin: 24px 0 16px;">解鎖成就</div>
                            
                            <div class="achievements-grid">
                                <div class="achievement-badge">
                                    <div class="achievement-icon">🏆</div>
                                    <div class="achievement-name">全勤達人</div>
                                    <div class="achievement-desc">連續100天</div>
                                </div>
                                <div class="achievement-badge">
                                    <div class="achievement-icon">⭐</div>
                                    <div class="achievement-name">任務大師</div>
                                    <div class="achievement-desc">完成365個</div>
                                </div>
                                <div class="achievement-badge">
                                    <div class="achievement-icon">🎯</div>
                                    <div class="achievement-name">目標達人</div>
                                    <div class="achievement-desc">達成率89%</div>
                                </div>
                                <div class="achievement-badge">
                                    <div class="achievement-icon">📚</div>
                                    <div class="achievement-name">閱讀之星</div>
                                    <div class="achievement-desc">完成18本</div>
                                </div>
                                <div class="achievement-badge">
                                    <div class="achievement-icon">💪</div>
                                    <div class="achievement-name">健康冠軍</div>
                                    <div class="achievement-desc">運動150次</div>
                                </div>
                                <div class="achievement-badge">
                                    <div class="achievement-icon">🔥</div>
                                    <div class="achievement-name">專注高手</div>
                                    <div class="achievement-desc">1250小時</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-bar">
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-home"></i></div>
                                <div class="tab-label">首頁</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="tab-label">待辦</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-calendar"></i></div>
                                <div class="tab-label">日曆</div>
                            </div>
                            <div class="tab-item active">
                                <div class="tab-icon"><i class="fas fa-chart-line"></i></div>
                                <div class="tab-label">統計</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-cog"></i></div>
                                <div class="tab-label">設定</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 7. 習慣追蹤 -->
            <div class="screen-wrapper">
                <div class="screen-label">🔄 習慣追蹤</div>
                <div class="iphone-frame">
                    <div class="phone-container">
                        <div class="status-bar">
                            <div class="status-left">9:41</div>
                            <div class="status-right">
                                <i class="fas fa-signal"></i>
                                <i class="fas fa-wifi"></i>
                                <i class="fas fa-battery-three-quarters"></i>
                            </div>
                        </div>
                        
                        <div class="content">
                            <div class="greeting">
                                <h2>習慣養成 🌱</h2>
                                <p>堅持就是勝利</p>
                            </div>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon">🔥</div>
                                    <div class="stat-value">15天</div>
                                    <div class="stat-label">最長連續</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">✨</div>
                                    <div class="stat-value">85%</div>
                                    <div class="stat-label">本週完成率</div>
                                </div>
                            </div>
                            
                            <div class="section-title" style="margin: 24px 0 16px;">今日習慣</div>
                            
                            <div class="habit-item">
                                <div class="habit-header">
                                    <div class="habit-info">
                                        <div class="habit-icon">🏃</div>
                                        <div>
                                            <div class="habit-name">晨間運動</div>
                                            <div class="habit-streak">🔥 連續 15 天</div>
                                        </div>
                                    </div>
                                    <div class="habit-check checked"></div>
                                </div>
                                <div class="habit-week">
                                    <div class="habit-day completed">一</div>
                                    <div class="habit-day completed">二</div>
                                    <div class="habit-day completed">三</div>
                                    <div class="habit-day completed">四</div>
                                    <div class="habit-day completed">五</div>
                                    <div class="habit-day completed">六</div>
                                    <div class="habit-day completed">日</div>
                                </div>
                            </div>
                            
                            <div class="habit-item">
                                <div class="habit-header">
                                    <div class="habit-info">
                                        <div class="habit-icon">📚</div>
                                        <div>
                                            <div class="habit-name">閱讀30分鐘</div>
                                            <div class="habit-streak">🔥 連續 12 天</div>
                                        </div>
                                    </div>
                                    <div class="habit-check checked"></div>
                                </div>
                                <div class="habit-week">
                                    <div class="habit-day completed">一</div>
                                    <div class="habit-day completed">二</div>
                                    <div class="habit-day completed">三</div>
                                    <div class="habit-day completed">四</div>
                                    <div class="habit-day completed">五</div>
                                    <div class="habit-day">六</div>
                                    <div class="habit-day completed">日</div>
                                </div>
                            </div>
                            
                            <div class="habit-item">
                                <div class="habit-header">
                                    <div class="habit-info">
                                        <div class="habit-icon">💧</div>
                                        <div>
                                            <div class="habit-name">喝水8杯</div>
                                            <div class="habit-streak">🔥 連續 8 天</div>
                                        </div>
                                    </div>
                                    <div class="habit-check"></div>
                                </div>
                                <div class="habit-week">
                                    <div class="habit-day completed">一</div>
                                    <div class="habit-day completed">二</div>
                                    <div class="habit-day">三</div>
                                    <div class="habit-day completed">四</div>
                                    <div class="habit-day completed">五</div>
                                    <div class="habit-day completed">六</div>
                                    <div class="habit-day">日</div>
                                </div>
                            </div>
                            
                            <div class="habit-item">
                                <div class="habit-header">
                                    <div class="habit-info">
                                        <div class="habit-icon">🧘</div>
                                        <div>
                                            <div class="habit-name">冥想10分鐘</div>
                                            <div class="habit-streak">🔥 連續 5 天</div>
                                        </div>
                                    </div>
                                    <div class="habit-check"></div>
                                </div>
                                <div class="habit-week">
                                    <div class="habit-day">一</div>
                                    <div class="habit-day completed">二</div>
                                    <div class="habit-day completed">三</div>
                                    <div class="habit-day">四</div>
                                    <div class="habit-day completed">五</div>
                                    <div class="habit-day completed">六</div>
                                    <div class="habit-day completed">日</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-bar">
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-home"></i></div>
                                <div class="tab-label">首頁</div>
                            </div>
                            <div class="tab-item active">
                                <div class="tab-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="tab-label">待辦</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-calendar"></i></div>
                                <div class="tab-label">日曆</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-chart-line"></i></div>
                                <div class="tab-label">統計</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-cog"></i></div>
                                <div class="tab-label">設定</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 8. 專注模式 -->
            <div class="screen-wrapper">
                <div class="screen-label">⏱️ 專注模式</div>
                <div class="iphone-frame">
                    <div class="phone-container">
                        <div class="status-bar">
                            <div class="status-left">9:41</div>
                            <div class="status-right">
                                <i class="fas fa-signal"></i>
                                <i class="fas fa-wifi"></i>
                                <i class="fas fa-battery-three-quarters"></i>
                            </div>
                        </div>
                        
                        <div class="content">
                            <div class="greeting">
                                <h2>專注計時 ⏳</h2>
                                <p>保持專注，高效工作</p>
                            </div>
                            
                            <div class="focus-timer">
                                <div class="timer-display">25:00</div>
                                <div class="timer-label">專注時間</div>
                                <div class="timer-controls">
                                    <div class="timer-btn primary">開始</div>
                                    <div class="timer-btn">重置</div>
                                </div>
                            </div>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon">🎯</div>
                                    <div class="stat-value">4</div>
                                    <div class="stat-label">今日番茄鐘</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">⏰</div>
                                    <div class="stat-value">2.5h</div>
                                    <div class="stat-label">專注時長</div>
                                </div>
                            </div>
                            
                            <div class="section-title" style="margin: 24px 0 16px;">今日記錄</div>
                            
                            <div class="task-card">
                                <div class="task-content" style="flex: 1;">
                                    <div class="task-title">完成產品設計稿</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 09:00 - 09:25 (25分鐘)
                                    </div>
                                </div>
                            </div>
                            
                            <div class="task-card">
                                <div class="task-content" style="flex: 1;">
                                    <div class="task-title">回覆客戶郵件</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 10:30 - 10:55 (25分鐘)
                                    </div>
                                </div>
                            </div>
                            
                            <div class="task-card">
                                <div class="task-content" style="flex: 1;">
                                    <div class="task-title">整理會議記錄</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 14:00 - 14:25 (25分鐘)
                                    </div>
                                </div>
                            </div>
                            
                            <div class="task-card">
                                <div class="task-content" style="flex: 1;">
                                    <div class="task-title">學習新技能</div>
                                    <div class="task-time">
                                        <i class="far fa-clock"></i> 16:00 - 16:25 (25分鐘)
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-bar">
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-home"></i></div>
                                <div class="tab-label">首頁</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="tab-label">待辦</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-calendar"></i></div>
                                <div class="tab-label">日曆</div>
                            </div>
                            <div class="tab-item active">
                                <div class="tab-icon"><i class="fas fa-chart-line"></i></div>
                                <div class="tab-label">統計</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-cog"></i></div>
                                <div class="tab-label">設定</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 9. 設定頁面 -->
            <div class="screen-wrapper">
                <div class="screen-label">⚙️ 設定頁面</div>
                <div class="iphone-frame">
                    <div class="phone-container">
                        <div class="status-bar">
                            <div class="status-left">9:41</div>
                            <div class="status-right">
                                <i class="fas fa-signal"></i>
                                <i class="fas fa-wifi"></i>
                                <i class="fas fa-battery-three-quarters"></i>
                            </div>
                        </div>
                        
                        <div class="content">
                            <div class="greeting">
                                <h2>設定 ⚙️</h2>
                                <p>個人化你的應用</p>
                            </div>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">個人資料</div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">👤</div>
                                        <div class="setting-text">編輯個人資料</div>
                                    </div>
                                    <div class="setting-arrow"><i class="fas fa-chevron-right"></i></div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">🔔</div>
                                        <div class="setting-text">通知設定</div>
                                    </div>
                                    <div class="setting-arrow"><i class="fas fa-chevron-right"></i></div>
                                </div>
                            </div>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">應用設定</div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">🎨</div>
                                        <div class="setting-text">主題設定</div>
                                    </div>
                                    <div class="setting-arrow"><i class="fas fa-chevron-right"></i></div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">⏰</div>
                                        <div class="setting-text">提醒設定</div>
                                    </div>
                                    <div class="setting-arrow"><i class="fas fa-chevron-right"></i></div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">📊</div>
                                        <div class="setting-text">數據統計</div>
                                    </div>
                                    <div class="setting-arrow"><i class="fas fa-chevron-right"></i></div>
                                </div>
                            </div>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">數據管理</div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">☁️</div>
                                        <div class="setting-text">雲端同步</div>
                                    </div>
                                    <div class="setting-arrow"><i class="fas fa-chevron-right"></i></div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">💾</div>
                                        <div class="setting-text">備份與還原</div>
                                    </div>
                                    <div class="setting-arrow"><i class="fas fa-chevron-right"></i></div>
                                </div>
                            </div>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">關於</div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">ℹ️</div>
                                        <div class="setting-text">關於 Orbit</div>
                                    </div>
                                    <div class="setting-arrow"><i class="fas fa-chevron-right"></i></div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">📝</div>
                                        <div class="setting-text">使用條款</div>
                                    </div>
                                    <div class="setting-arrow"><i class="fas fa-chevron-right"></i></div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <div class="setting-icon">🔒</div>
                                        <div class="setting-text">隱私政策</div>
                                    </div>
                                    <div class="setting-arrow"><i class="fas fa-chevron-right"></i></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-bar">
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-home"></i></div>
                                <div class="tab-label">首頁</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-check-circle"></i></div>
                                <div class="tab-label">待辦</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-calendar"></i></div>
                                <div class="tab-label">日曆</div>
                            </div>
                            <div class="tab-item">
                                <div class="tab-icon"><i class="fas fa-chart-line"></i></div>
                                <div class="tab-label">統計</div>
                            </div>
                            <div class="tab-item active">
                                <div class="tab-icon"><i class="fas fa-cog"></i></div>
                                <div class="tab-label">設定</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- 新增任務模態對話框 -->
    <div class="modal-overlay" id="taskModal">
        <div class="modal-content">
            <div class="modal-title">📝 新增任務</div>
            <input type="text" class="modal-input" id="taskTitle" placeholder="任務名稱" />
            <input type="text" class="modal-input" id="taskTime" placeholder="時間（例如：上午 10:00）" value="上午 10:00" />
            <select class="modal-input" id="taskPriority">
                <option value="low">低優先級</option>
                <option value="medium" selected>普通優先級</option>
                <option value="high">高優先級</option>
            </select>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-secondary" onclick="closeModal('taskModal')">取消</button>
                <button class="modal-btn modal-btn-primary" onclick="submitTask()">確定</button>
            </div>
        </div>
    </div>

    <!-- 新增習慣模態對話框 -->
    <div class="modal-overlay" id="habitModal">
        <div class="modal-content">
            <div class="modal-title">🌱 新增習慣</div>
            <input type="text" class="modal-input" id="habitName" placeholder="習慣名稱" />
            <input type="text" class="modal-input" id="habitIcon" placeholder="圖標（emoji）" value="✨" />
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-secondary" onclick="closeModal('habitModal')">取消</button>
                <button class="modal-btn modal-btn-primary" onclick="submitHabit()">確定</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== 數據管理 ====================
        
        // 初始化數據結構
        let appData = {
            tasks: [],
            habits: [],
            goals: [],
            focusSessions: [],
            currentDate: new Date(),
            settings: {
                pomodoroTime: 25,
                shortBreak: 5,
                longBreak: 15
            }
        };

        // 從 localStorage 載入數據
        function loadData() {
            const savedData = localStorage.getItem('orbitAppData');
            if (savedData) {
                appData = JSON.parse(savedData);
                appData.currentDate = new Date(appData.currentDate);
            } else {
                // 初始化默認數據
                initDefaultData();
            }
        }

        // 保存數據到 localStorage
        function saveData() {
            localStorage.setItem('orbitAppData', JSON.stringify(appData));
        }

        // 初始化默認數據
        function initDefaultData() {
            appData.tasks = [
                { id: 1, title: '團隊會議', time: '10:00 AM', completed: false, priority: 'high', date: getTodayString() },
                { id: 2, title: '完成專案提案', time: '2:00 PM', completed: true, priority: 'medium', date: getTodayString() },
                { id: 3, title: '完成產品設計稿', time: '上午 10:00', completed: false, priority: 'high', date: getTodayString() },
                { id: 4, title: '回覆客戶郵件', time: '下午 2:00', completed: false, priority: 'medium', date: getTodayString() },
                { id: 5, title: '整理會議記錄', time: '下午 4:00', completed: false, priority: 'medium', date: getTodayString() },
                { id: 6, title: '晨間運動', time: '上午 7:00', completed: true, priority: 'high', date: getTodayString() },
                { id: 7, title: '閱讀30分鐘', time: '上午 8:00', completed: true, priority: 'medium', date: getTodayString() }
            ];

            appData.habits = [
                { id: 1, name: '晨間運動', icon: '🏃', streak: 15, completed: [true, true, true, true, true, true, true] },
                { id: 2, name: '閱讀30分鐘', icon: '📚', streak: 12, completed: [true, true, true, true, true, false, true] },
                { id: 3, name: '喝水8杯', icon: '💧', streak: 8, completed: [true, true, false, true, true, true, false] },
                { id: 4, name: '冥想10分鐘', icon: '🧘', streak: 5, completed: [false, true, true, false, true, true, true] }
            ];

            appData.goals = [
                { id: 1, title: '完成專業認證', category: '💼 職涯發展', progress: 85 },
                { id: 2, title: '閱讀 24 本書', category: '📚 個人成長', progress: 75, current: 18, target: 24 },
                { id: 3, title: '減重 10 公斤', category: '💪 健康生活', progress: 60, current: 6, target: 10 },
                { id: 4, title: '學會一門外語', category: '🌍 技能學習', progress: 45 }
            ];

            saveData();
        }

        // 獲取今天日期字符串
        function getTodayString() {
            const today = new Date();
            return `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
        }

        // ==================== UI 更新函數 ====================

        // 更新統計數據
        function updateStats() {
            const today = getTodayString();
            const todayTasks = appData.tasks.filter(t => t.date === today);
            const completedTasks = todayTasks.filter(t => t.completed);
            
            // 計算本週任務數（本週目標）
            const weekTasks = getWeekTasks();
            const weekGoalsCount = weekTasks.length;
            
            // 計算最長連續打卡天數
            const longestStreak = calculateLongestStreak();
            
            // 更新首頁統計（第一個屏幕的統計卡片）
            const screens = document.querySelectorAll('.screen-wrapper');
            if (screens.length > 0) {
                const homeScreen = screens[0]; // 首頁儀表板
                const statCards = homeScreen.querySelectorAll('.stat-card');
                
                if (statCards.length >= 4) {
                    // 今日任務
                    statCards[0].querySelector('.stat-value').textContent = todayTasks.length;
                    // 已完成
                    statCards[1].querySelector('.stat-value').textContent = completedTasks.length;
                    // 本週目標
                    statCards[2].querySelector('.stat-value').textContent = weekGoalsCount;
                    // 連續打卡
                    statCards[3].querySelector('.stat-value').textContent = longestStreak + '天';
                }
            }

            // 更新進度條
            const progress = todayTasks.length > 0 ? Math.round((completedTasks.length / todayTasks.length) * 100) : 0;
            const progressFills = document.querySelectorAll('.progress-bar-fill');
            const progressPercentages = document.querySelectorAll('.progress-percentage');
            
            progressFills.forEach(fill => fill.style.width = `${progress}%`);
            progressPercentages.forEach(percent => percent.textContent = `${progress}%`);
        }
        
        // 獲取本週的所有任務
        function getWeekTasks() {
            const today = new Date();
            const dayOfWeek = today.getDay(); // 0 = Sunday, 1 = Monday, ...
            const monday = new Date(today);
            monday.setDate(today.getDate() - (dayOfWeek === 0 ? 6 : dayOfWeek - 1));
            
            const weekTasks = [];
            for (let i = 0; i < 7; i++) {
                const date = new Date(monday);
                date.setDate(monday.getDate() + i);
                const dateString = formatDate(date);
                const dayTasks = appData.tasks.filter(t => t.date === dateString);
                weekTasks.push(...dayTasks);
            }
            return weekTasks;
        }
        
        // 計算最長連續打卡天數（從習慣追蹤中）
        function calculateLongestStreak() {
            if (!appData.habits || appData.habits.length === 0) return 0;
            
            let maxStreak = 0;
            appData.habits.forEach(habit => {
                if (habit.streak > maxStreak) {
                    maxStreak = habit.streak;
                }
            });
            
            return maxStreak;
        }
        
        // 格式化日期為 YYYY-MM-DD
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // 渲染週計劃
        function renderWeekPlan() {
            const today = new Date();
            const dayOfWeek = today.getDay(); // 0 = Sunday, 1 = Monday, ...
            const monday = new Date(today);
            
            // 計算本週一的日期
            monday.setDate(today.getDate() - (dayOfWeek === 0 ? 6 : dayOfWeek - 1));
            
            // 計算本週日的日期
            const sunday = new Date(monday);
            sunday.setDate(monday.getDate() + 6);
            
            // 找到週計劃屏幕
            const screens = document.querySelectorAll('.screen-wrapper');
            let weekPlanScreen = null;
            
            screens.forEach(screen => {
                const title = screen.querySelector('.greeting h2');
                if (title && title.textContent.includes('本週計劃')) {
                    weekPlanScreen = screen;
                }
            });
            
            if (!weekPlanScreen) return;
            
            // 更新週計劃標題
            const greeting = weekPlanScreen.querySelector('.greeting p');
            if (greeting) {
                greeting.textContent = `${monday.getMonth() + 1}月 ${monday.getDate()}日 - ${sunday.getMonth() + 1}月 ${sunday.getDate()}日`;
            }
            
            // 生成7天的日曆
            const weekGrid = weekPlanScreen.querySelector('.week-grid');
            if (weekGrid) {
                weekGrid.innerHTML = '';
                
                const dayNames = ['週日', '週一', '週二', '週三', '週四', '週五', '週六'];
                
                // 從週一開始生成7天
                for (let i = 0; i < 7; i++) {
                    const currentDate = new Date(monday);
                    currentDate.setDate(monday.getDate() + i);
                    
                    const dateString = formatDate(currentDate);
                    const dayTasks = appData.tasks.filter(t => t.date === dateString);
                    
                    // 判斷是否是今天
                    const isToday = dateString === getTodayString();
                    
                    const dayCell = document.createElement('div');
                    dayCell.className = `day-cell${isToday ? ' today' : ''}`;
                    dayCell.dataset.date = dateString;
                    
                    // 日期名稱
                    const dayName = document.createElement('div');
                    dayName.className = 'day-name';
                    dayName.textContent = dayNames[(i + 1) % 7]; // 週一開始
                    
                    // 日期數字
                    const dayNumber = document.createElement('div');
                    dayNumber.className = 'day-number';
                    dayNumber.textContent = currentDate.getDate();
                    
                    // 任務圓點
                    const dayDots = document.createElement('div');
                    dayDots.className = 'day-dots';
                    
                    // 最多顯示3個圓點
                    const dotsCount = Math.min(dayTasks.length, 3);
                    for (let j = 0; j < dotsCount; j++) {
                        const dot = document.createElement('div');
                        dot.className = 'day-dot';
                        dayDots.appendChild(dot);
                    }
                    
                    dayCell.appendChild(dayName);
                    dayCell.appendChild(dayNumber);
                    dayCell.appendChild(dayDots);
                    
                    // 添加點擊事件
                    dayCell.addEventListener('click', () => {
                        // 移除其他日期的選中狀態
                        weekGrid.querySelectorAll('.day-cell').forEach(cell => {
                            cell.classList.remove('selected');
                        });
                        
                        // 選中當前日期
                        dayCell.classList.add('selected');
                        
                        // 更新任務列表顯示該日期的任務
                        renderWeekTasks(dateString);
                        
                        showToast(`已切換到 ${currentDate.getMonth() + 1}月${currentDate.getDate()}日`, 'success');
                    });
                    
                    weekGrid.appendChild(dayCell);
                }
            }
            
            // 渲染本週任務（默認顯示今天的任務）
            renderWeekTasks(getTodayString());
        }
        
        // 渲染週任務列表
        function renderWeekTasks(dateString) {
            const screens = document.querySelectorAll('.screen-wrapper');
            let weekPlanScreen = null;
            
            screens.forEach(screen => {
                const title = screen.querySelector('.greeting h2');
                if (title && title.textContent.includes('本週計劃')) {
                    weekPlanScreen = screen;
                }
            });
            
            if (!weekPlanScreen) return;
            
            // 如果沒有指定日期，顯示本週所有任務
            let tasksToShow;
            let titleText;
            
            if (dateString) {
                tasksToShow = appData.tasks.filter(t => t.date === dateString);
                const date = new Date(dateString);
                titleText = `${date.getMonth() + 1}月${date.getDate()}日任務`;
            } else {
                tasksToShow = getWeekTasks();
                titleText = '本週任務';
            }
            
            // 找到或創建任務列表容器
            let taskListContainer = weekPlanScreen.querySelector('.week-tasks-container');
            if (!taskListContainer) {
                // 如果不存在，創建一個
                const weekGrid = weekPlanScreen.querySelector('.week-grid');
                taskListContainer = document.createElement('div');
                taskListContainer.className = 'week-tasks-container';
                weekGrid.insertAdjacentElement('afterend', taskListContainer);
            }
            
            // 生成任務列表HTML
            let tasksHTML = `
                <div class="section-title" style="margin: 24px 0 16px;">${titleText}</div>
            `;
            
            if (tasksToShow.length === 0) {
                tasksHTML += `
                    <div style="text-align: center; padding: 40px 20px; color: #8b7355; font-size: 14px;">
                        <i class="far fa-calendar-check" style="font-size: 48px; opacity: 0.3; display: block; margin-bottom: 16px;"></i>
                        暫無任務
                    </div>
                `;
            } else {
                tasksToShow.forEach(task => {
                    tasksHTML += createTaskHTML(task, task.completed);
                });
            }
            
            // 添加新增任務按鈕
            tasksHTML += `
                <div style="margin-top: 20px; text-align: center;">
                    <button onclick="addWeekTask()" style="
                        padding: 14px 32px;
                        background: linear-gradient(135deg, #e8d4b8 0%, #ddb892 50%, #c9a882 100%);
                        color: #5d4e37;
                        border: none;
                        border-radius: 16px;
                        font-size: 15px;
                        font-weight: 500;
                        cursor: pointer;
                        box-shadow: 0 2px 8px rgba(93, 78, 55, 0.2);
                        transition: all 0.3s ease;
                        font-family: 'Noto Sans TC', sans-serif;
                    " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(93, 78, 55, 0.3)'" 
                       onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(93, 78, 55, 0.2)'">
                        <i class="fas fa-plus"></i> 新增週任務
                    </button>
                </div>
            `;
            
            taskListContainer.innerHTML = tasksHTML;
        }
        
        // 新增週任務
        function addWeekTask() {
            // 獲取當前選中的日期
            const weekPlanScreen = document.querySelector('.screen-wrapper .greeting h2');
            let selectedDate = getTodayString();
            
            if (weekPlanScreen && weekPlanScreen.textContent.includes('本週計劃')) {
                const selectedCell = document.querySelector('.week-grid .day-cell.selected');
                if (selectedCell && selectedCell.dataset.date) {
                    selectedDate = selectedCell.dataset.date;
                }
            }
            
            // 暫存選中的日期
            window.selectedWeekDate = selectedDate;
            
            // 打開任務模態框
            openModal('taskModal');
        }

        // 渲染任務列表
        function renderTasks() {
            const today = getTodayString();
            const todayTasks = appData.tasks.filter(t => t.date === today);
            const pendingTasks = todayTasks.filter(t => !t.completed);
            const completedTasks = todayTasks.filter(t => t.completed);

            // 找到所有任務容器（首頁和每日待辦頁面）
            const taskContainers = document.querySelectorAll('.screen-wrapper');
            
            taskContainers.forEach(container => {
                const title = container.querySelector('.greeting h2');
                
                // 更新首頁的任務列表
                if (title && (title.textContent.includes('早安') || title.textContent.includes('午安') || title.textContent.includes('晚安'))) {
                    const taskCardsContainer = container.querySelectorAll('.task-card');
                    if (taskCardsContainer.length > 0) {
                        // 找到"即將到來"區域並更新
                        const sectionHeaders = container.querySelectorAll('.section-header');
                        sectionHeaders.forEach(header => {
                            const sectionTitle = header.querySelector('.section-title');
                            if (sectionTitle && sectionTitle.textContent.includes('即將到來')) {
                                // 獲取父容器
                                let parent = header.parentElement;
                                // 移除舊的任務卡片
                                const oldCards = parent.querySelectorAll('.task-card');
                                oldCards.forEach(card => card.remove());
                                
                                // 添加新的任務卡片（最多顯示2個）
                                const tasksToShow = pendingTasks.slice(0, 2);
                                tasksToShow.forEach(task => {
                                    const taskHTML = createTaskHTML(task, false);
                                    const tempDiv = document.createElement('div');
                                    tempDiv.innerHTML = taskHTML;
                                    header.insertAdjacentElement('afterend', tempDiv.firstElementChild);
                                });
                            }
                        });
                    }
                }
                
                // 更新每日待辦頁面
                if (title && title.textContent.includes('今日待辦')) {
                    const content = container.querySelector('.content');
                    
                    // 重新渲染任務列表
                    let tasksHTML = `
                        <div class="greeting">
                            <h2>今日待辦 📝</h2>
                            <p>還有 ${pendingTasks.length} 個任務待完成</p>
                        </div>
                        
                        <div class="progress-section">
                            <div class="progress-header">
                                <div class="progress-title">完成度</div>
                                <div class="progress-percentage">${todayTasks.length > 0 ? Math.round((completedTasks.length / todayTasks.length) * 100) : 0}%</div>
                            </div>
                            <div class="progress-bar-bg">
                                <div class="progress-bar-fill" style="width: ${todayTasks.length > 0 ? Math.round((completedTasks.length / todayTasks.length) * 100) : 0}%"></div>
                            </div>
                        </div>
                        
                        <div class="section-title" style="margin-bottom: 16px;">進行中</div>
                    `;

                    // 添加待處理任務
                    pendingTasks.forEach(task => {
                        tasksHTML += createTaskHTML(task, false);
                    });

                    tasksHTML += `<div class="section-title" style="margin: 24px 0 16px;">已完成</div>`;

                    // 添加已完成任務
                    completedTasks.forEach(task => {
                        tasksHTML += createTaskHTML(task, true);
                    });

                    // 添加新增任務按鈕
                    tasksHTML += `
                        <div style="margin-top: 20px; text-align: center;">
                            <button onclick="addTask()" style="
                                padding: 14px 32px;
                                background: linear-gradient(135deg, #e8d4b8 0%, #ddb892 50%, #c9a882 100%);
                                border: none;
                                border-radius: 12px;
                                color: #3a3a3c;
                                font-size: 15px;
                                font-weight: 600;
                                cursor: pointer;
                                box-shadow: 0 2px 8px rgba(93, 78, 55, 0.2);
                                transition: all 0.3s ease;
                                font-family: 'Noto Sans TC', sans-serif;
                            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(93, 78, 55, 0.3)'" 
                               onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(93, 78, 55, 0.2)'">
                                <i class="fas fa-plus"></i> 新增任務
                            </button>
                        </div>
                    `;

                    content.innerHTML = tasksHTML;
                    
                    // 重新綁定事件
                    bindTaskEvents(content);
                }
            });

            updateStats();
        }

        // 創建任務HTML
        function createTaskHTML(task, isCompleted) {
            return `
                <div class="task-card" data-task-id="${task.id}" style="${isCompleted ? 'opacity: 0.6;' : ''}">
                    <div class="task-checkbox ${task.completed ? 'checked' : ''}" onclick="toggleTask(${task.id})"></div>
                    <div class="task-content" onclick="editTask(${task.id})" style="cursor: pointer; flex: 1;">
                        <div class="task-title" style="${task.completed ? 'text-decoration: line-through;' : ''}">${task.title}</div>
                        <div class="task-time">
                            <i class="far fa-clock"></i> ${task.time}
                        </div>
                    </div>
                    <div class="task-priority priority-${task.priority}"></div>
                    <div class="task-delete" onclick="deleteTask(${task.id})" style="cursor: pointer; color: #d4a574; padding: 8px; margin-left: 8px;">
                        <i class="fas fa-trash-alt"></i>
                    </div>
                </div>
            `;
        }

        // 打開模態對話框
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('active');
                // 清空輸入框
                if (modalId === 'taskModal') {
                    document.getElementById('taskTitle').value = '';
                    document.getElementById('taskTime').value = '上午 10:00';
                    document.getElementById('taskPriority').value = 'medium';
                } else if (modalId === 'habitModal') {
                    document.getElementById('habitName').value = '';
                    document.getElementById('habitIcon').value = '✨';
                }
            }
        }

        // 關閉模態對話框
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
            }
        }

        // 點擊模態背景關閉
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal-overlay')) {
                closeModal(e.target.id);
            }
        });

        // 新增任務（打開模態）
        function addTask() {
            openModal('taskModal');
        }

        // 提交任務
        function submitTask() {
            const title = document.getElementById('taskTitle').value.trim();
            const time = document.getElementById('taskTime').value.trim();
            const priority = document.getElementById('taskPriority').value;
            
            if (!title) {
                alert('請輸入任務名稱！');
                return;
            }
            
            // 優先使用月曆日期，其次週計劃日期，最後今天
            const taskDate = window.selectedMonthDate || window.selectedWeekDate || getTodayString();
            
            const newTask = {
                id: Date.now(),
                title: title,
                time: time,
                completed: false,
                priority: priority,
                date: taskDate
            };
            
            appData.tasks.push(newTask);
            saveData();
            renderTasks();
            renderWeekPlan(); // 更新週計劃
            renderCalendar(); // 更新月曆
            closeModal('taskModal');
            
            // 清除選中的日期
            window.selectedWeekDate = null;
            window.selectedMonthDate = null;
            
            // 顯示成功提示
            showToast('✅ 任務添加成功！');
        }

        // 編輯任務
        function editTask(taskId) {
            const task = appData.tasks.find(t => t.id === taskId);
            if (!task) return;
            
            // 填充當前任務數據到模態框
            document.getElementById('taskTitle').value = task.title;
            document.getElementById('taskTime').value = task.time;
            document.getElementById('taskPriority').value = task.priority;
            
            // 修改提交按鈕的行為
            const modal = document.getElementById('taskModal');
            const modalTitle = modal.querySelector('.modal-title');
            const submitBtn = modal.querySelector('.modal-btn-primary');
            
            modalTitle.textContent = '✏️ 編輯任務';
            submitBtn.textContent = '更新';
            submitBtn.onclick = () => {
                const title = document.getElementById('taskTitle').value.trim();
                const time = document.getElementById('taskTime').value.trim();
                const priority = document.getElementById('taskPriority').value;
                
                if (!title) {
                    alert('請輸入任務名稱！');
                    return;
                }
                
                task.title = title;
                task.time = time;
                task.priority = priority;
                
                saveData();
                renderTasks();
                closeModal('taskModal');
                
                // 恢復原始狀態
                modalTitle.textContent = '📝 新增任務';
                submitBtn.textContent = '確定';
                submitBtn.onclick = submitTask;
                
                showToast('✅ 任務更新成功！');
            };
            
            openModal('taskModal');
        }

        // 刪除任務
        function deleteTask(taskId) {
            event.stopPropagation(); // 防止觸發父元素的點擊事件
            
            if (!confirm('確定要刪除這個任務嗎？')) return;
            
            const index = appData.tasks.findIndex(t => t.id === taskId);
            if (index !== -1) {
                const taskCard = document.querySelector(`[data-task-id="${taskId}"]`);
                
                // 添加刪除動畫
                if (taskCard) {
                    taskCard.style.transition = 'all 0.3s ease';
                    taskCard.style.transform = 'translateX(-100%)';
                    taskCard.style.opacity = '0';
                    
                    setTimeout(() => {
                        appData.tasks.splice(index, 1);
                        saveData();
                        renderTasks();
                        showToast('🗑️ 任務已刪除');
                    }, 300);
                } else {
                    appData.tasks.splice(index, 1);
                    saveData();
                    renderTasks();
                    showToast('🗑️ 任務已刪除');
                }
            }
        }

        // 綁定任務事件
        function bindTaskEvents(container) {
            const checkboxes = container.querySelectorAll('.task-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.style.cursor = 'pointer';
            });
        }

        // 切換任務完成狀態
        function toggleTask(taskId) {
            event.stopPropagation(); // 防止觸發父元素的點擊事件
            
            const task = appData.tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                saveData();
                
                // 添加動畫效果和即時反饋
                const taskCard = document.querySelector(`[data-task-id="${taskId}"]`);
                if (taskCard) {
                    taskCard.style.transition = 'all 0.3s ease';
                    taskCard.style.transform = 'scale(0.95)';
                    
                    setTimeout(() => {
                        taskCard.style.transform = 'scale(1)';
                        renderTasks();
                        
                        if (task.completed) {
                            showToast('✅ 任務完成！');
                        }
                    }, 150);
                } else {
                    renderTasks();
                }
            }
        }

        // 當前顯示的年月
        let currentYear = new Date().getFullYear();
        let currentMonth = new Date().getMonth(); // 0-11
        
        // 渲染月曆
        function renderCalendar() {
            // 找到月曆屏幕
            const screens = document.querySelectorAll('.screen-wrapper');
            let calendarScreen = null;
            
            screens.forEach(screen => {
                const label = screen.querySelector('.screen-label');
                if (label && label.textContent.includes('月曆視圖')) {
                    calendarScreen = screen;
                }
            });
            
            if (!calendarScreen) return;
            
            // 更新月份標題
            const calendarTitle = calendarScreen.querySelector('.calendar-title');
            if (calendarTitle) {
                calendarTitle.textContent = `${currentYear}年 ${currentMonth + 1}月`;
            }
            
            // 獲取該月的第一天和最後一天
            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startDayOfWeek = firstDay.getDay(); // 0 = Sunday
            
            // 獲取上個月的最後幾天
            const prevMonthLastDay = new Date(currentYear, currentMonth, 0).getDate();
            
            // 生成日曆格子
            const calendarDays = calendarScreen.querySelector('.calendar-days');
            if (calendarDays) {
                calendarDays.innerHTML = '';
                
                // 添加上個月的日期（填充空白）
                for (let i = startDayOfWeek - 1; i >= 0; i--) {
                    const dayDiv = createCalendarDay(
                        prevMonthLastDay - i,
                        currentYear,
                        currentMonth - 1,
                        true // other-month
                    );
                    calendarDays.appendChild(dayDiv);
                }
                
                // 添加本月的日期
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayDiv = createCalendarDay(day, currentYear, currentMonth, false);
                    calendarDays.appendChild(dayDiv);
                }
                
                // 添加下個月的日期（填充剩餘空白）
                const totalCells = calendarDays.children.length;
                const remainingCells = 42 - totalCells; // 6行 x 7列 = 42格
                for (let day = 1; day <= remainingCells; day++) {
                    const dayDiv = createCalendarDay(
                        day,
                        currentYear,
                        currentMonth + 1,
                        true // other-month
                    );
                    calendarDays.appendChild(dayDiv);
                }
            }
            
            // 渲染今日活動（默認顯示今天）
            const today = new Date();
            if (today.getMonth() === currentMonth && today.getFullYear() === currentYear) {
                renderMonthActivities(formatDate(today));
            } else {
                renderMonthActivities(null);
            }
        }
        
        // 創建日曆日期格子
        function createCalendarDay(day, year, month, isOtherMonth) {
            const dayDiv = document.createElement('div');
            dayDiv.className = 'calendar-day';
            dayDiv.textContent = day;
            
            // 處理跨月情況
            let actualMonth = month;
            let actualYear = year;
            if (month < 0) {
                actualMonth = 11;
                actualYear = year - 1;
            } else if (month > 11) {
                actualMonth = 0;
                actualYear = year + 1;
            }
            
            const dateString = `${actualYear}-${String(actualMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
            dayDiv.dataset.date = dateString;
            
            if (isOtherMonth) {
                dayDiv.classList.add('other-month');
            }
            
            // 檢查是否是今天
            const today = getTodayString();
            if (dateString === today && !isOtherMonth) {
                dayDiv.classList.add('today');
            }
            
            // 檢查是否有任務（事件）
            if (!isOtherMonth) {
                const dayTasks = appData.tasks.filter(t => t.date === dateString);
                if (dayTasks.length > 0) {
                    dayDiv.classList.add('has-events');
                }
            }
            
            // 添加點擊事件
            if (!isOtherMonth) {
                dayDiv.style.cursor = 'pointer';
                dayDiv.addEventListener('click', () => {
                    // 移除其他日期的選中狀態
                    document.querySelectorAll('.calendar-day').forEach(d => {
                        d.classList.remove('selected');
                    });
                    
                    // 選中當前日期
                    dayDiv.classList.add('selected');
                    
                    // 顯示該日期的活動
                    renderMonthActivities(dateString);
                    
                    const date = new Date(dateString);
                    showToast(`已切換到 ${date.getMonth() + 1}月${date.getDate()}日`, 'success');
                });
            }
            
            return dayDiv;
        }
        
        // 渲染月活動列表
        function renderMonthActivities(dateString) {
            const screens = document.querySelectorAll('.screen-wrapper');
            let calendarScreen = null;
            
            screens.forEach(screen => {
                const label = screen.querySelector('.screen-label');
                if (label && label.textContent.includes('月曆視圖')) {
                    calendarScreen = screen;
                }
            });
            
            if (!calendarScreen) return;
            
            // 找到或創建活動列表容器
            let activitiesContainer = calendarScreen.querySelector('.month-activities-container');
            if (!activitiesContainer) {
                const calendarDays = calendarScreen.querySelector('.calendar-days');
                activitiesContainer = document.createElement('div');
                activitiesContainer.className = 'month-activities-container';
                activitiesContainer.style.marginTop = '24px';
                calendarDays.insertAdjacentElement('afterend', activitiesContainer);
            }
            
            let activitiesHTML = '';
            
            if (dateString) {
                const date = new Date(dateString);
                const dayTasks = appData.tasks.filter(t => t.date === dateString);
                
                activitiesHTML = `
                    <div class="section-title" style="margin-bottom: 16px;">
                        ${date.getMonth() + 1}月${date.getDate()}日活動
                    </div>
                `;
                
                if (dayTasks.length === 0) {
                    activitiesHTML += `
                        <div style="text-align: center; padding: 40px 20px; color: #8b7355; font-size: 14px;">
                            <i class="far fa-calendar-check" style="font-size: 48px; opacity: 0.3; display: block; margin-bottom: 16px;"></i>
                            當天無活動
                        </div>
                    `;
                } else {
                    dayTasks.forEach(task => {
                        activitiesHTML += createTaskHTML(task, task.completed);
                    });
                }
                
                // 添加新增活動按鈕
                activitiesHTML += `
                    <div style="margin-top: 20px; text-align: center;">
                        <button onclick="addMonthActivity('${dateString}')" style="
                            padding: 14px 32px;
                            background: linear-gradient(135deg, #e8d4b8 0%, #ddb892 50%, #c9a882 100%);
                            color: #5d4e37;
                            border: none;
                            border-radius: 16px;
                            font-size: 15px;
                            font-weight: 500;
                            cursor: pointer;
                            box-shadow: 0 2px 8px rgba(93, 78, 55, 0.2);
                            transition: all 0.3s ease;
                            font-family: 'Noto Sans TC', sans-serif;
                        " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(93, 78, 55, 0.3)'" 
                           onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(93, 78, 55, 0.2)'">
                            <i class="fas fa-plus"></i> 新增活動
                        </button>
                    </div>
                `;
            } else {
                activitiesHTML = `
                    <div class="section-title" style="margin-bottom: 16px;">今日活動</div>
                    <div style="text-align: center; padding: 40px 20px; color: #8b7355; font-size: 14px;">
                        <i class="far fa-calendar" style="font-size: 48px; opacity: 0.3; display: block; margin-bottom: 16px;"></i>
                        請點擊日期查看活動
                    </div>
                `;
            }
            
            activitiesContainer.innerHTML = activitiesHTML;
        }
        
        // 新增月活動
        function addMonthActivity(dateString) {
            // 暫存選中的日期
            window.selectedMonthDate = dateString;
            
            // 打開任務模態框
            openModal('taskModal');
        }
        
        // 切換月份
        function changeMonth(offset) {
            currentMonth += offset;
            
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            } else if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            
            renderCalendar();
            showToast(`已切換到 ${currentYear}年${currentMonth + 1}月`, 'success');
        }
        
        // 初始化月曆導航按鈕
        function initCalendarNav() {
            const screens = document.querySelectorAll('.screen-wrapper');
            let calendarScreen = null;
            
            screens.forEach(screen => {
                const label = screen.querySelector('.screen-label');
                if (label && label.textContent.includes('月曆視圖')) {
                    calendarScreen = screen;
                }
            });
            
            if (!calendarScreen) return;
            
            const navBtns = calendarScreen.querySelectorAll('.nav-btn');
            if (navBtns.length >= 2) {
                // 左箭頭 - 上個月
                navBtns[0].addEventListener('click', () => {
                    changeMonth(-1);
                });
                
                // 右箭頭 - 下個月
                navBtns[1].addEventListener('click', () => {
                    changeMonth(1);
                });
                
                // 添加視覺反饋
                navBtns.forEach(btn => {
                    btn.style.cursor = 'pointer';
                    btn.style.transition = 'all 0.3s ease';
                    
                    btn.addEventListener('mouseenter', () => {
                        btn.style.transform = 'scale(1.1)';
                        btn.style.color = '#d4a574';
                    });
                    
                    btn.addEventListener('mouseleave', () => {
                        btn.style.transform = 'scale(1)';
                        btn.style.color = '';
                    });
                });
            }
        }

        // 渲染年度目標
        function renderGoals() {
            // 找到年度規劃屏幕
            const screens = document.querySelectorAll('.screen-wrapper');
            let goalsScreen = null;
            
            screens.forEach(screen => {
                const title = screen.querySelector('.greeting h2');
                if (title && title.textContent.includes('年度目標')) {
                    goalsScreen = screen;
                }
            });
            
            if (!goalsScreen || !appData.goals) return;
            
            // 更新目標統計
            const totalGoals = appData.goals.length;
            const completedGoals = appData.goals.filter(g => g.progress >= 100).length;
            
            const statCards = goalsScreen.querySelectorAll('.stat-card');
            if (statCards.length >= 2) {
                statCards[0].querySelector('.stat-value').textContent = totalGoals;
                statCards[1].querySelector('.stat-value').textContent = completedGoals;
            }
            
            // 找到目標清單容器
            const sectionTitle = goalsScreen.querySelector('.section-title');
            if (!sectionTitle) return;
            
            // 清空舊的目標卡片
            let nextElement = sectionTitle.nextElementSibling;
            while (nextElement && nextElement.classList.contains('goal-card')) {
                const toRemove = nextElement;
                nextElement = nextElement.nextElementSibling;
                toRemove.remove();
            }
            
            // 渲染目標卡片
            appData.goals.forEach(goal => {
                const goalCard = createGoalCard(goal);
                sectionTitle.insertAdjacentElement('afterend', goalCard);
            });
            
            // 添加新增目標按鈕
            const addGoalBtn = document.createElement('div');
            addGoalBtn.style.cssText = 'margin-top: 20px; text-align: center;';
            addGoalBtn.innerHTML = `
                <button onclick="openGoalModal()" style="
                    padding: 14px 32px;
                    background: linear-gradient(135deg, #e8d4b8 0%, #ddb892 50%, #c9a882 100%);
                    color: #5d4e37;
                    border: none;
                    border-radius: 16px;
                    font-size: 15px;
                    font-weight: 500;
                    cursor: pointer;
                    box-shadow: 0 2px 8px rgba(93, 78, 55, 0.2);
                    transition: all 0.3s ease;
                    font-family: 'Noto Sans TC', sans-serif;
                " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(93, 78, 55, 0.3)'" 
                   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(93, 78, 55, 0.2)'">
                    <i class="fas fa-plus"></i> 新增年度目標
                </button>
            `;
            
            // 在最後一個目標卡片後添加按鈕
            const lastGoalCard = goalsScreen.querySelector('.goal-card:last-of-type');
            if (lastGoalCard) {
                lastGoalCard.insertAdjacentElement('afterend', addGoalBtn);
            } else {
                sectionTitle.insertAdjacentElement('afterend', addGoalBtn);
            }
        }
        
        // 創建目標卡片
        function createGoalCard(goal) {
            const card = document.createElement('div');
            card.className = 'goal-card';
            card.dataset.goalId = goal.id;
            card.style.cursor = 'pointer';
            
            // 計算進度文字
            let progressText = `${goal.progress}%`;
            if (goal.current !== undefined && goal.target !== undefined) {
                progressText = `${goal.current}/${goal.target}`;
            }
            
            card.innerHTML = `
                <div class="goal-header">
                    <div>
                        <div class="goal-title">${goal.title}</div>
                        <div class="goal-category">${goal.category}</div>
                    </div>
                </div>
                <div class="goal-progress">
                    <div class="goal-progress-bar">
                        <div class="goal-progress-fill" style="width: ${goal.progress}%"></div>
                    </div>
                    <div class="goal-progress-text">${progressText}</div>
                </div>
                <div class="goal-actions" style="margin-top: 12px; display: flex; gap: 8px; justify-content: flex-end;">
                    <button onclick="editGoal(${goal.id}); event.stopPropagation();" style="
                        padding: 6px 12px;
                        background: linear-gradient(135deg, #e8d4b8, #ddb892);
                        color: #5d4e37;
                        border: none;
                        border-radius: 8px;
                        font-size: 12px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    ">
                        <i class="fas fa-edit"></i> 編輯
                    </button>
                    <button onclick="deleteGoal(${goal.id}); event.stopPropagation();" style="
                        padding: 6px 12px;
                        background: linear-gradient(135deg, #d4a574, #c9a882);
                        color: #ffffff;
                        border: none;
                        border-radius: 8px;
                        font-size: 12px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    ">
                        <i class="fas fa-trash-alt"></i> 刪除
                    </button>
                </div>
            `;
            
            // 添加點擊事件（點擊卡片查看詳情）
            card.addEventListener('click', () => {
                viewGoalDetails(goal.id);
            });
            
            return card;
        }
        
        // 查看目標詳情
        function viewGoalDetails(goalId) {
            const goal = appData.goals.find(g => g.id === goalId);
            if (!goal) return;
            
            let detailsText = `目標：${goal.title}\n分類：${goal.category}\n進度：${goal.progress}%`;
            
            if (goal.current !== undefined && goal.target !== undefined) {
                detailsText += `\n當前值：${goal.current}\n目標值：${goal.target}`;
            }
            
            alert(detailsText);
        }
        
        // 打開目標模態框
        function openGoalModal(goalId = null) {
            const modal = document.getElementById('goalModal');
            if (!modal) {
                createGoalModal();
            }
            
            const modalTitle = document.querySelector('#goalModal .modal-title');
            const titleInput = document.getElementById('goalTitle');
            const categoryInput = document.getElementById('goalCategory');
            const progressInput = document.getElementById('goalProgress');
            const currentInput = document.getElementById('goalCurrent');
            const targetInput = document.getElementById('goalTarget');
            const submitBtn = document.querySelector('#goalModal .modal-btn-primary');
            
            if (goalId) {
                // 編輯模式
                const goal = appData.goals.find(g => g.id === goalId);
                if (!goal) return;
                
                modalTitle.textContent = '✏️ 編輯目標';
                titleInput.value = goal.title;
                categoryInput.value = goal.category;
                progressInput.value = goal.progress;
                currentInput.value = goal.current || '';
                targetInput.value = goal.target || '';
                
                submitBtn.textContent = '更新';
                submitBtn.onclick = () => updateGoal(goalId);
            } else {
                // 新增模式
                modalTitle.textContent = '🎯 新增年度目標';
                titleInput.value = '';
                categoryInput.value = '💼 職涯發展';
                progressInput.value = '0';
                currentInput.value = '';
                targetInput.value = '';
                
                submitBtn.textContent = '確定';
                submitBtn.onclick = submitGoal;
            }
            
            document.getElementById('goalModal').classList.add('active');
        }
        
        // 創建目標模態框
        function createGoalModal() {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.id = 'goalModal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-title">🎯 新增年度目標</div>
                    <input type="text" class="modal-input" id="goalTitle" placeholder="目標名稱（例如：閱讀 24 本書）" />
                    <select class="modal-input" id="goalCategory">
                        <option value="💼 職涯發展">💼 職涯發展</option>
                        <option value="📚 個人成長">📚 個人成長</option>
                        <option value="💪 健康生活">💪 健康生活</option>
                        <option value="🌍 技能學習">🌍 技能學習</option>
                        <option value="💰 財務目標">💰 財務目標</option>
                        <option value="👨‍👩‍👧 家庭關係">👨‍👩‍👧 家庭關係</option>
                    </select>
                    <input type="number" class="modal-input" id="goalProgress" placeholder="完成百分比（0-100）" min="0" max="100" value="0" />
                    <div style="display: flex; gap: 8px;">
                        <input type="number" class="modal-input" id="goalCurrent" placeholder="當前值（選填）" style="flex: 1;" />
                        <input type="number" class="modal-input" id="goalTarget" placeholder="目標值（選填）" style="flex: 1;" />
                    </div>
                    <div class="modal-buttons">
                        <button class="modal-btn modal-btn-secondary" onclick="closeModal('goalModal')">取消</button>
                        <button class="modal-btn modal-btn-primary" onclick="submitGoal()">確定</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // 點擊背景關閉
            modal.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal-overlay')) {
                    closeModal('goalModal');
                }
            });
        }
        
        // 提交新目標
        function submitGoal() {
            const title = document.getElementById('goalTitle').value.trim();
            const category = document.getElementById('goalCategory').value;
            const progress = parseInt(document.getElementById('goalProgress').value) || 0;
            const current = document.getElementById('goalCurrent').value.trim();
            const target = document.getElementById('goalTarget').value.trim();
            
            if (!title) {
                alert('請輸入目標名稱！');
                return;
            }
            
            const newGoal = {
                id: Date.now(),
                title: title,
                category: category,
                progress: Math.min(100, Math.max(0, progress))
            };
            
            // 如果有當前值和目標值，添加到目標對象
            if (current && target) {
                newGoal.current = parseInt(current);
                newGoal.target = parseInt(target);
                // 自動計算進度
                newGoal.progress = Math.round((newGoal.current / newGoal.target) * 100);
            }
            
            appData.goals.push(newGoal);
            saveData();
            renderGoals();
            closeModal('goalModal');
            
            showToast('✅ 目標新增成功！');
        }
        
        // 編輯目標
        function editGoal(goalId) {
            openGoalModal(goalId);
        }
        
        // 更新目標
        function updateGoal(goalId) {
            const goal = appData.goals.find(g => g.id === goalId);
            if (!goal) return;
            
            const title = document.getElementById('goalTitle').value.trim();
            const category = document.getElementById('goalCategory').value;
            const progress = parseInt(document.getElementById('goalProgress').value) || 0;
            const current = document.getElementById('goalCurrent').value.trim();
            const target = document.getElementById('goalTarget').value.trim();
            
            if (!title) {
                alert('請輸入目標名稱！');
                return;
            }
            
            goal.title = title;
            goal.category = category;
            goal.progress = Math.min(100, Math.max(0, progress));
            
            // 更新當前值和目標值
            if (current && target) {
                goal.current = parseInt(current);
                goal.target = parseInt(target);
                // 自動計算進度
                goal.progress = Math.round((goal.current / goal.target) * 100);
            } else {
                // 如果清空了，移除這些屬性
                delete goal.current;
                delete goal.target;
            }
            
            saveData();
            renderGoals();
            closeModal('goalModal');
            
            showToast('✅ 目標更新成功！');
        }
        
        // 刪除目標
        function deleteGoal(goalId) {
            if (!confirm('確定要刪除這個目標嗎？')) return;
            
            const index = appData.goals.findIndex(g => g.id === goalId);
            if (index !== -1) {
                appData.goals.splice(index, 1);
                saveData();
                renderGoals();
                showToast('🗑️ 目標已刪除');
            }
        }

        // 渲染年度總結
        function renderYearSummary() {
            // 找到年度總結屏幕
            const screens = document.querySelectorAll('.screen-wrapper');
            let summaryScreen = null;
            
            screens.forEach(screen => {
                const title = screen.querySelector('.greeting h2');
                if (title && title.textContent.includes('年度回顧')) {
                    summaryScreen = screen;
                }
            });
            
            if (!summaryScreen) return;
            
            // 計算年度統計
            const yearStats = calculateYearStats();
            
            // 更新年度統計卡片
            const summaryStats = summaryScreen.querySelectorAll('.summary-stat');
            if (summaryStats.length >= 3) {
                summaryStats[0].querySelector('.summary-value').textContent = yearStats.completedTasks;
                summaryStats[1].querySelector('.summary-value').textContent = yearStats.goalCompletionRate + '%';
                summaryStats[2].querySelector('.summary-value').textContent = yearStats.focusHours.toLocaleString();
            }
            
            // 渲染月度趨勢圖
            renderMonthlyTrend(summaryScreen, yearStats.monthlyData);
            
            // 渲染解鎖成就
            renderAchievements(summaryScreen, yearStats);
        }
        
        // 計算年度統計
        function calculateYearStats() {
            const currentYear = new Date().getFullYear();
            
            // 1. 計算完成任務總數（全年）
            const completedTasks = appData.tasks.filter(t => {
                if (!t.completed || !t.date) return false;
                const taskYear = new Date(t.date).getFullYear();
                return taskYear === currentYear;
            }).length;
            
            // 2. 計算目標達成率
            let goalCompletionRate = 0;
            if (appData.goals && appData.goals.length > 0) {
                const completedGoals = appData.goals.filter(g => g.progress >= 100).length;
                goalCompletionRate = Math.round((completedGoals / appData.goals.length) * 100);
            }
            
            // 3. 計算專注時數（假設每個完成的任務平均專注 0.5 小時）
            const focusHours = Math.round(completedTasks * 0.5);
            
            // 4. 計算每月數據
            const monthlyData = [];
            for (let month = 0; month < 12; month++) {
                const monthTasks = appData.tasks.filter(t => {
                    if (!t.date) return false;
                    const taskDate = new Date(t.date);
                    return taskDate.getFullYear() === currentYear && 
                           taskDate.getMonth() === month &&
                           t.completed;
                }).length;
                monthlyData.push(monthTasks);
            }
            
            // 5. 計算最長連續天數
            const longestStreak = calculateLongestTaskStreak();
            
            // 6. 計算總任務數（包括未完成）
            const totalTasks = appData.tasks.filter(t => {
                if (!t.date) return false;
                const taskYear = new Date(t.date).getFullYear();
                return taskYear === currentYear;
            }).length;
            
            return {
                completedTasks,
                goalCompletionRate,
                focusHours,
                monthlyData,
                longestStreak,
                totalTasks
            };
        }
        
        // 計算最長連續完成任務天數
        function calculateLongestTaskStreak() {
            if (!appData.tasks || appData.tasks.length === 0) return 0;
            
            // 獲取所有有完成任務的日期
            const completedDates = [...new Set(
                appData.tasks
                    .filter(t => t.completed && t.date)
                    .map(t => t.date)
            )].sort();
            
            if (completedDates.length === 0) return 0;
            
            let maxStreak = 1;
            let currentStreak = 1;
            
            for (let i = 1; i < completedDates.length; i++) {
                const prevDate = new Date(completedDates[i - 1]);
                const currDate = new Date(completedDates[i]);
                const diffDays = Math.round((currDate - prevDate) / (1000 * 60 * 60 * 24));
                
                if (diffDays === 1) {
                    currentStreak++;
                    maxStreak = Math.max(maxStreak, currentStreak);
                } else {
                    currentStreak = 1;
                }
            }
            
            return maxStreak;
        }
        
        // 渲染月度趨勢圖
        function renderMonthlyTrend(summaryScreen, monthlyData) {
            const chartBars = summaryScreen.querySelector('.chart-bars');
            if (!chartBars) return;
            
            chartBars.innerHTML = '';
            
            const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', 
                               '7月', '8月', '9月', '10月', '11月', '12月'];
            
            // 找出最大值用於計算百分比
            const maxValue = Math.max(...monthlyData, 1);
            
            monthlyData.forEach((count, index) => {
                const barHeight = maxValue > 0 ? (count / maxValue) * 100 : 0;
                
                const barDiv = document.createElement('div');
                barDiv.className = 'chart-bar';
                barDiv.style.height = barHeight + '%';
                barDiv.title = `${monthNames[index]}：完成 ${count} 個任務`;
                
                const labelDiv = document.createElement('div');
                labelDiv.className = 'chart-label';
                labelDiv.textContent = monthNames[index];
                
                barDiv.appendChild(labelDiv);
                
                // 添加點擊事件查看詳情
                barDiv.addEventListener('click', () => {
                    showMonthDetails(index, count);
                });
                
                chartBars.appendChild(barDiv);
            });
        }
        
        // 顯示月度詳情
        function showMonthDetails(monthIndex, taskCount) {
            const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', 
                               '7月', '8月', '9月', '10月', '11月', '12月'];
            alert(`${monthNames[monthIndex]}詳細數據\n\n完成任務數：${taskCount} 個`);
        }
        
        // 渲染解鎖成就
        function renderAchievements(summaryScreen, yearStats) {
            const achievementsGrid = summaryScreen.querySelector('.achievements-grid');
            if (!achievementsGrid) return;
            
            achievementsGrid.innerHTML = '';
            
            // 定義成就系統
            const achievements = [
                {
                    icon: '🏆',
                    name: '全勤達人',
                    desc: `連續${yearStats.longestStreak}天`,
                    unlocked: yearStats.longestStreak >= 7,
                    requirement: '連續完成任務7天'
                },
                {
                    icon: '⭐',
                    name: '任務大師',
                    desc: `完成${yearStats.completedTasks}個`,
                    unlocked: yearStats.completedTasks >= 100,
                    requirement: '完成100個任務'
                },
                {
                    icon: '🎯',
                    name: '目標達人',
                    desc: `達成率${yearStats.goalCompletionRate}%`,
                    unlocked: yearStats.goalCompletionRate >= 80,
                    requirement: '目標達成率80%'
                },
                {
                    icon: '🔥',
                    name: '專注高手',
                    desc: `${yearStats.focusHours}小時`,
                    unlocked: yearStats.focusHours >= 100,
                    requirement: '專注100小時'
                },
                {
                    icon: '📚',
                    name: '閱讀之星',
                    desc: getGoalProgress('閱讀'),
                    unlocked: checkGoalCompleted('閱讀'),
                    requirement: '完成閱讀目標'
                },
                {
                    icon: '💪',
                    name: '健康冠軍',
                    desc: getGoalProgress('健康'),
                    unlocked: checkGoalCompleted('健康'),
                    requirement: '完成健康目標'
                }
            ];
            
            achievements.forEach(achievement => {
                const badge = document.createElement('div');
                badge.className = 'achievement-badge';
                if (!achievement.unlocked) {
                    badge.style.opacity = '0.4';
                    badge.style.filter = 'grayscale(1)';
                }
                badge.style.cursor = 'pointer';
                
                badge.innerHTML = `
                    <div class="achievement-icon">${achievement.icon}</div>
                    <div class="achievement-name">${achievement.name}</div>
                    <div class="achievement-desc">${achievement.desc}</div>
                `;
                
                // 添加點擊事件查看詳情
                badge.addEventListener('click', () => {
                    showAchievementDetails(achievement);
                });
                
                achievementsGrid.appendChild(badge);
            });
            
            // 添加分享按鈕
            const shareBtn = document.createElement('div');
            shareBtn.style.cssText = 'margin-top: 20px; text-align: center;';
            shareBtn.innerHTML = `
                <button onclick="shareYearReport()" style="
                    padding: 14px 32px;
                    background: linear-gradient(135deg, #e8d4b8 0%, #ddb892 50%, #c9a882 100%);
                    color: #5d4e37;
                    border: none;
                    border-radius: 16px;
                    font-size: 15px;
                    font-weight: 500;
                    cursor: pointer;
                    box-shadow: 0 2px 8px rgba(93, 78, 55, 0.2);
                    transition: all 0.3s ease;
                    font-family: 'Noto Sans TC', sans-serif;
                " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(93, 78, 55, 0.3)'" 
                   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(93, 78, 55, 0.2)'">
                    <i class="fas fa-share-alt"></i> 分享年度報告
                </button>
            `;
            
            achievementsGrid.insertAdjacentElement('afterend', shareBtn);
        }
        
        // 獲取目標進度描述
        function getGoalProgress(keyword) {
            if (!appData.goals) return '未設定';
            
            const goal = appData.goals.find(g => g.title.includes(keyword));
            if (!goal) return '未設定';
            
            if (goal.current && goal.target) {
                return `完成${goal.current}/${goal.target}`;
            }
            return `進度${goal.progress}%`;
        }
        
        // 檢查目標是否完成
        function checkGoalCompleted(keyword) {
            if (!appData.goals) return false;
            
            const goal = appData.goals.find(g => g.title.includes(keyword));
            return goal && goal.progress >= 100;
        }
        
        // 顯示成就詳情
        function showAchievementDetails(achievement) {
            const status = achievement.unlocked ? '✅ 已解鎖' : '🔒 未解鎖';
            const message = `${achievement.icon} ${achievement.name}\n\n${status}\n\n${achievement.desc}\n\n解鎖條件：${achievement.requirement}`;
            alert(message);
        }
        
        // 分享年度報告
        function shareYearReport() {
            const yearStats = calculateYearStats();
            
            const report = `🌲 我的 ${new Date().getFullYear()} 年度報告 🌲\n\n` +
                          `✅ 完成任務：${yearStats.completedTasks} 個\n` +
                          `🎯 目標達成率：${yearStats.goalCompletionRate}%\n` +
                          `⏱️ 專注時數：${yearStats.focusHours} 小時\n` +
                          `🔥 最長連續：${yearStats.longestStreak} 天\n\n` +
                          `來自 Orbit 時間管理`;
            
            // 嘗試使用 Web Share API
            if (navigator.share) {
                navigator.share({
                    title: '我的年度報告',
                    text: report
                }).then(() => {
                    showToast('✅ 分享成功！');
                }).catch((error) => {
                    console.log('分享取消', error);
                    copyToClipboard(report);
                });
            } else {
                // 降級方案：複製到剪貼板
                copyToClipboard(report);
            }
        }
        
        // 複製到剪貼板
        function copyToClipboard(text) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    showToast('✅ 已複製到剪貼板！');
                }).catch(() => {
                    fallbackCopyToClipboard(text);
                });
            } else {
                fallbackCopyToClipboard(text);
            }
        }
        
        // 降級複製方案
        function fallbackCopyToClipboard(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            document.body.appendChild(textArea);
            textArea.select();
            
            try {
                document.execCommand('copy');
                showToast('✅ 已複製到剪貼板！');
            } catch (err) {
                alert('無法複製，請手動複製：\n\n' + text);
            }
            
            document.body.removeChild(textArea);
        }

        // 渲染習慣追蹤
        function renderHabits() {
            const habitContainers = document.querySelectorAll('.screen-wrapper');
            
            habitContainers.forEach(container => {
                const title = container.querySelector('.greeting h2');
                if (title && title.textContent.includes('習慣養成')) {
                    const content = container.querySelector('.content');
                    
                    // 計算本週完成率（週日=今天）
                    const completedToday = appData.habits.filter(h => h.completed[6]).length;
                    const completionRate = appData.habits.length > 0 ? Math.round((completedToday / appData.habits.length) * 100) : 0;
                    
                    // 計算最長連續天數
                    const longestStreak = appData.habits.length > 0 
                        ? Math.max(...appData.habits.map(h => h.streak)) 
                        : 0;
                    
                    let habitsHTML = `
                        <div class="greeting">
                            <h2>習慣養成 🌱</h2>
                            <p>堅持就是勝利</p>
                        </div>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon">🔥</div>
                                <div class="stat-value">${longestStreak}天</div>
                                <div class="stat-label">最長連續</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">✨</div>
                                <div class="stat-value">${completionRate}%</div>
                                <div class="stat-label">本週完成率</div>
                            </div>
                        </div>
                        
                        <div class="section-title" style="margin: 24px 0 16px;">今日習慣</div>
                    `;

                    appData.habits.forEach(habit => {
                        habitsHTML += createHabitHTML(habit);
                    });

                    // 添加新增習慣按鈕
                    habitsHTML += `
                        <div style="margin-top: 20px; text-align: center;">
                            <button onclick="addHabit()" style="
                                padding: 14px 32px;
                                background: linear-gradient(135deg, #e8d4b8 0%, #ddb892 50%, #c9a882 100%);
                                border: none;
                                border-radius: 12px;
                                color: #3a3a3c;
                                font-size: 15px;
                                font-weight: 600;
                                cursor: pointer;
                                box-shadow: 0 2px 8px rgba(93, 78, 55, 0.2);
                                transition: all 0.3s ease;
                                font-family: 'Noto Sans TC', sans-serif;
                            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(93, 78, 55, 0.3)'" 
                               onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(93, 78, 55, 0.2)'">
                                <i class="fas fa-plus"></i> 新增習慣
                            </button>
                        </div>
                    `;

                    content.innerHTML = habitsHTML;
                    bindHabitEvents(content);
                }
            });
        }

        // 創建習慣HTML
        function createHabitHTML(habit) {
            const weekDays = ['一', '二', '三', '四', '五', '六', '日'];
            const isCompletedToday = habit.completed[6];
            
            return `
                <div class="habit-item" data-habit-id="${habit.id}" style="position: relative;">
                    <div class="habit-header">
                        <div class="habit-info">
                            <div class="habit-icon">${habit.icon}</div>
                            <div>
                                <div class="habit-name">${habit.name}</div>
                                <div class="habit-streak">🔥 連續 ${habit.streak} 天</div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <div class="habit-check ${isCompletedToday ? 'checked' : ''}" onclick="toggleHabit(${habit.id})"></div>
                            <div onclick="deleteHabit(${habit.id})" style="cursor: pointer; color: #d4a574; padding: 4px;">
                                <i class="fas fa-trash-alt"></i>
                            </div>
                        </div>
                    </div>
                    <div class="habit-week">
                        ${weekDays.map((day, index) => `
                            <div class="habit-day ${habit.completed[index] ? 'completed' : ''}">${day}</div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // 新增習慣（打開模態）
        function addHabit() {
            openModal('habitModal');
        }

        // 提交習慣
        function submitHabit() {
            const name = document.getElementById('habitName').value.trim();
            const icon = document.getElementById('habitIcon').value.trim();
            
            if (!name) {
                alert('請輸入習慣名稱！');
                return;
            }
            
            const newHabit = {
                id: Date.now(),
                name: name,
                icon: icon || '✨',
                streak: 0,
                completed: [false, false, false, false, false, false, false]
            };
            
            appData.habits.push(newHabit);
            saveData();
            renderHabits();
            closeModal('habitModal');
            
            showToast('✅ 習慣添加成功！');
        }

        // 顯示Toast提示
        function showToast(message) {
            // 創建toast元素
            const toast = document.createElement('div');
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #e8d4b8 0%, #ddb892 100%);
                color: #3a3a3c;
                padding: 12px 24px;
                border-radius: 12px;
                box-shadow: 0 4px 16px rgba(93, 78, 55, 0.3);
                font-weight: 600;
                z-index: 10000;
                animation: toastSlideIn 0.3s ease-out;
                font-family: 'Noto Sans TC', sans-serif;
            `;
            
            document.body.appendChild(toast);
            
            // 3秒後移除
            setTimeout(() => {
                toast.style.animation = 'toastSlideOut 0.3s ease-out';
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }

        // 添加toast動畫CSS
        const style = document.createElement('style');
        style.textContent = `
            @keyframes toastSlideIn {
                from {
                    opacity: 0;
                    transform: translateX(-50%) translateY(-20px);
                }
                to {
                    opacity: 1;
                    transform: translateX(-50%) translateY(0);
                }
            }
            @keyframes toastSlideOut {
                from {
                    opacity: 1;
                    transform: translateX(-50%) translateY(0);
                }
                to {
                    opacity: 0;
                    transform: translateX(-50%) translateY(-20px);
                }
            }
        `;
        document.head.appendChild(style);

        // 刪除習慣
        function deleteHabit(habitId) {
            event.stopPropagation(); // 防止觸發父元素的點擊事件
            
            if (!confirm('確定要刪除這個習慣嗎？')) return;
            
            const index = appData.habits.findIndex(h => h.id === habitId);
            if (index !== -1) {
                const habitCard = document.querySelector(`[data-habit-id="${habitId}"]`);
                
                // 添加刪除動畫
                if (habitCard) {
                    habitCard.style.transition = 'all 0.3s ease';
                    habitCard.style.transform = 'translateX(-100%)';
                    habitCard.style.opacity = '0';
                    
                    setTimeout(() => {
                        appData.habits.splice(index, 1);
                        saveData();
                        renderHabits();
                        showToast('🗑️ 習慣已刪除');
                    }, 300);
                } else {
                    appData.habits.splice(index, 1);
                    saveData();
                    renderHabits();
                    showToast('🗑️ 習慣已刪除');
                }
            }
        }

        // 綁定習慣事件
        function bindHabitEvents(container) {
            const checks = container.querySelectorAll('.habit-check');
            checks.forEach(check => {
                check.style.cursor = 'pointer';
            });
        }

        // 切換習慣完成狀態
        function toggleHabit(habitId) {
            event.stopPropagation(); // 防止觸發父元素的點擊事件
            
            const habit = appData.habits.find(h => h.id === habitId);
            if (habit) {
                habit.completed[6] = !habit.completed[6];
                
                // 更新連續天數
                if (habit.completed[6]) {
                    habit.streak++;
                    showToast(`🔥 ${habit.name} 打卡成功！連續 ${habit.streak} 天`);
                } else {
                    if (habit.streak > 0) habit.streak--;
                }
                
                saveData();
                
                // 添加動畫效果
                const habitCard = document.querySelector(`[data-habit-id="${habitId}"]`);
                if (habitCard) {
                    habitCard.style.transition = 'all 0.3s ease';
                    habitCard.style.transform = 'scale(0.98)';
                    
                    setTimeout(() => {
                        habitCard.style.transform = 'scale(1)';
                        renderHabits();
                    }, 150);
                } else {
                    renderHabits();
                }
            }
        }

        // ==================== 專注計時器 ====================
        
        let timerInterval = null;
        let timerSeconds = 25 * 60; // 25分鐘
        let isTimerRunning = false;

        function initTimer() {
            const timerContainers = document.querySelectorAll('.screen-wrapper');
            
            timerContainers.forEach(container => {
                const title = container.querySelector('.greeting h2');
                if (title && title.textContent.includes('專注計時')) {
                    const startBtn = container.querySelector('.timer-btn.primary');
                    const resetBtn = container.querySelectorAll('.timer-btn')[1];
                    
                    if (startBtn) {
                        startBtn.onclick = toggleTimer;
                    }
                    if (resetBtn) {
                        resetBtn.onclick = resetTimer;
                    }
                }
            });
        }

        function toggleTimer() {
            if (isTimerRunning) {
                pauseTimer();
            } else {
                startTimer();
            }
        }

        function startTimer() {
            isTimerRunning = true;
            const btn = document.querySelector('.timer-btn.primary');
            if (btn) btn.textContent = '暫停';
            
            timerInterval = setInterval(() => {
                if (timerSeconds > 0) {
                    timerSeconds--;
                    updateTimerDisplay();
                } else {
                    completeTimer();
                }
            }, 1000);
        }

        function pauseTimer() {
            isTimerRunning = false;
            const btn = document.querySelector('.timer-btn.primary');
            if (btn) btn.textContent = '繼續';
            clearInterval(timerInterval);
        }

        function resetTimer() {
            isTimerRunning = false;
            clearInterval(timerInterval);
            timerSeconds = 25 * 60;
            updateTimerDisplay();
            const btn = document.querySelector('.timer-btn.primary');
            if (btn) btn.textContent = '開始';
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timerSeconds / 60);
            const seconds = timerSeconds % 60;
            const display = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            
            const timerDisplays = document.querySelectorAll('.timer-display');
            timerDisplays.forEach(d => d.textContent = display);
        }

        function completeTimer() {
            pauseTimer();
            
            // 記錄專注時段
            const now = new Date();
            const session = {
                id: Date.now(),
                date: getTodayString(),
                startTime: new Date(now.getTime() - 25 * 60 * 1000).toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit', hour12: false }),
                endTime: now.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit', hour12: false }),
                duration: 25,
                taskName: '專注時段'
            };
            
            appData.focusSessions.push(session);
            saveData();
            renderFocusSessions();
            
            // 顯示完成提示
            showToast('🎉 專注時間完成！休息一下吧！', 'success');
            
            // 播放提示音（如果瀏覽器支持）
            playNotificationSound();
            
            resetTimer();
        }
        
        // 播放提示音
        function playNotificationSound() {
            try {
                const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuAyvLZhzgIHm/A7+OZSA0PVqzn77BgGQY/mdvyw3IlBSyBzvLYiTcIGWi77+efTRAMUKfj8LZjHAY4ktfyzHksBSR3x/DdkEAKFF606+uoVRQKRp/g8r5sIQUrgsny2Yc4CB5vwO/jmUgND1as5++wYBkGP5nb8sNyJQUsgc7y2Ik3CBlou+/nn0wQDFCn4/C2YxwGOJLX8sx5LAUkd8fw3ZBKChdQr+Xvr1kWCUqj4u+8ayEFK4HJ8tmHOAgeb8Dv45lIDQ9WrOfvsGAZBj+Z2/LDciUFLIHO8tiJNwgZaLvv559MEAxQp+PwtmMcBjiS1/LMeSwFJHfH8N2QSgoXUK/l769ZFglKo+LvvGshBSuByfLZhzgIHm/A7+OZSA0PVqzn77BgGQY/mdvyw3IlBSyBzvLYiTcIGWi77+efTRAMUKfj8LZjHAY4ktfyzHksBSR3x/DdkEoKF1Cv5e+vWRYJSqPi77xrIQUrgsny2Yc4CB5vwO/jmUgND1as5++wYBkGP5nb8sNyJQUsgc7y2Ik3CBlou+/nn0wQDFCn4/C2YxwGOJLX8sx5LAUkd8fw3ZBKChdQr+Xvr1kWCUqj4u+8ayEFK4LJ8tmHOAgeb8Dv45lIDQ9WrOfvsGAZBj+Z2/LDciUFLIHO8tiJNwgZaLvv559MEAxQp+PwtmMcBjiS1/LMeSwFJHfH8N2QSgoXUK/l769ZFglKo+LvvGshBSuCyfLZhzgIHm/A7+OZSA0PVqzn77BgGQY/mdvyw3IlBSyBzvLYiTcIGWi77+efTRAMUKfj8LZjHAY4ktfyzHksBSR3x/DdkEoKF1Cv5e+vWRYJSqPi77xrIQUrgsny2Yc4CB5vwO/jmUgND1as5++wYBkGP5nb8sNyJQUsgc7y2Ik3CBlou+/nn0wQDFCn4/C2YxwGOJLX8sx5LAUkd8fw3ZBKChdQr+Xvr1kWCUqj4u+8ayEFK4LJ8tmHOAgeb8Dv45lIDQ9WrOfvsGAZBj+Z2/LDciUFLIHO8tiJNwgZaLvv559MEAxQp+PwtmMcBjiS1/LMeSwFJHfH8N2QSgoXUK/l769ZFglKo+LvvGshBQ==');
                audio.play().catch(() => {});
            } catch (e) {}
        }
        
        // 渲染專注時段記錄
        function renderFocusSessions() {
            const focusContainers = document.querySelectorAll('.screen-wrapper');
            
            focusContainers.forEach(container => {
                const title = container.querySelector('.greeting h2');
                if (title && title.textContent.includes('專注計時')) {
                    const content = container.querySelector('.content');
                    if (!content) return;
                    
                    // 獲取今天的專注記錄
                    const today = getTodayString();
                    const todaySessions = appData.focusSessions.filter(s => s.date === today);
                    
                    // 計算統計數據
                    const sessionCount = todaySessions.length;
                    const totalMinutes = todaySessions.reduce((sum, s) => sum + s.duration, 0);
                    const totalHours = (totalMinutes / 60).toFixed(1);
                    
                    // 更新統計卡片
                    const statCards = content.querySelectorAll('.stat-card');
                    if (statCards.length >= 2) {
                        statCards[0].querySelector('.stat-value').textContent = sessionCount;
                        statCards[1].querySelector('.stat-value').textContent = totalHours + 'h';
                    }
                    
                    // 查找今日記錄部分
                    let recordsSection = content.querySelector('.focus-records-section');
                    if (!recordsSection) {
                        // 如果不存在，找到 section-title 並在其後插入
                        const sectionTitle = content.querySelector('.section-title');
                        if (sectionTitle) {
                            recordsSection = document.createElement('div');
                            recordsSection.className = 'focus-records-section';
                            
                            // 移除舊的任務卡片
                            let nextElement = sectionTitle.nextElementSibling;
                            while (nextElement && nextElement.classList.contains('task-card')) {
                                const toRemove = nextElement;
                                nextElement = nextElement.nextElementSibling;
                                toRemove.remove();
                            }
                            
                            sectionTitle.insertAdjacentElement('afterend', recordsSection);
                        }
                    }
                    
                    if (recordsSection) {
                        if (todaySessions.length === 0) {
                            recordsSection.innerHTML = `
                                <div style="text-align: center; padding: 40px 20px; color: #8b7355; font-size: 14px;">
                                    <i class="far fa-clock" style="font-size: 48px; opacity: 0.3; display: block; margin-bottom: 16px;"></i>
                                    今天還沒有專注記錄
                                </div>
                            `;
                        } else {
                            recordsSection.innerHTML = todaySessions.map(session => `
                                <div class="task-card">
                                    <div class="task-content" style="flex: 1;">
                                        <div class="task-title">${session.taskName || '專注時段'}</div>
                                        <div class="task-time">
                                            <i class="far fa-clock"></i> ${session.startTime} - ${session.endTime} (${session.duration}分鐘)
                                        </div>
                                    </div>
                                </div>
                            `).join('');
                        }
                    }
                }
            });
        }

        // ==================== 標籤欄切換 ====================
        
        function initTabBar() {
            const screens = document.querySelectorAll('.screen-wrapper');
            
            screens.forEach((screen, screenIndex) => {
                const tabItems = screen.querySelectorAll('.tab-item');
                
                tabItems.forEach((tab, tabIndex) => {
                    tab.style.cursor = 'pointer';
                    
                    tab.addEventListener('click', () => {
                        // 移除當前屏幕所有標籤的 active 狀態
                        tabItems.forEach(t => t.classList.remove('active'));
                        
                        // 添加點擊的標籤 active 狀態
                        tab.classList.add('active');
                        
                        // 添加點擊動畫
                        tab.style.transform = 'scale(0.9)';
                        setTimeout(() => {
                            tab.style.transform = 'scale(1)';
                        }, 150);
                        
                        // 這裡可以添加切換頁面內容的邏輯
                        const tabLabel = tab.querySelector('.tab-label').textContent;
                        console.log(`切換到: ${tabLabel}`);
                    });
                });
            });
        }

        // ==================== 日曆交互 ====================
        
        // 舊的 initCalendar 函數已被 renderCalendar 和 initCalendarNav 取代

        // ==================== 設定項目交互 ====================
        
        function initSettings() {
            const settingItems = document.querySelectorAll('.setting-item');
            
            settingItems.forEach(item => {
                item.addEventListener('click', () => {
                    const settingText = item.querySelector('.setting-text').textContent;
                    handleSettingClick(settingText);
                });
            });
        }
        
        // 處理設定項目點擊
        function handleSettingClick(settingName) {
            switch(settingName) {
                case '編輯個人資料':
                    openProfileSettings();
                    break;
                case '通知設定':
                    openNotificationSettings();
                    break;
                case '主題設定':
                    openThemeSettings();
                    break;
                case '提醒設定':
                    openReminderSettings();
                    break;
                case '數據統計':
                    openDataStats();
                    break;
                case '雲端同步':
                    syncToCloud();
                    break;
                case '備份與還原':
                    openBackupRestore();
                    break;
                case '導出數據':
                    exportData();
                    break;
                case '關於 Orbit':
                    openAboutOrbit();
                    break;
                case '使用條款':
                    openTermsOfService();
                    break;
                case '隱私政策':
                    openPrivacyPolicy();
                    break;
                default:
                    showToast(`打開: ${settingName}`);
            }
        }
        
        // 👤 編輯個人資料
        function openProfileSettings() {
            const currentName = appData.settings.userName || '用戶';
            const newName = prompt('請輸入您的名稱：', currentName);
            
            if (newName && newName.trim()) {
                appData.settings.userName = newName.trim();
                saveData();
                showToast('✅ 個人資料已更新！');
            }
        }
        
        // 🔔 通知設定
        function openNotificationSettings() {
            const message = `通知設定\n\n` +
                          `□ 任務提醒\n` +
                          `□ 習慣打卡提醒\n` +
                          `□ 番茄鐘結束提醒\n` +
                          `□ 每日總結提醒\n\n` +
                          `(瀏覽器通知需要授權)`;
            
            if (confirm(message + '\n\n是否啟用瀏覽器通知？')) {
                requestNotificationPermission();
            }
        }
        
        // 請求通知權限
        function requestNotificationPermission() {
            if ('Notification' in window) {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        showToast('✅ 通知權限已授予！');
                        new Notification('Orbit 時間管理', {
                            body: '您將會收到重要提醒通知',
                            icon: '🌲'
                        });
                    } else {
                        showToast('❌ 通知權限被拒絕');
                    }
                });
            } else {
                showToast('❌ 您的瀏覽器不支持通知功能');
            }
        }
        
        // 🎨 主題設定
        function openThemeSettings() {
            const themes = [
                '木質溫暖調（當前）',
                'iOS 清新風格',
                '賽博朋克',
                '漸變糖果',
                'RPG 遊戲風格'
            ];
            
            const message = `選擇主題：\n\n` +
                          themes.map((t, i) => `${i + 1}. ${t}`).join('\n') +
                          `\n\n當前使用：木質溫暖調`;
            
            alert(message);
            showToast('💡 主題切換功能即將推出！');
        }
        
        // ⏰ 提醒設定
        function openReminderSettings() {
            const currentTime = appData.settings.reminderTime || '09:00';
            const newTime = prompt('設置每日提醒時間（格式：HH:MM）：', currentTime);
            
            if (newTime && /^([01]?[0-9]|2[0-3]):[0-5][0-9]$/.test(newTime)) {
                appData.settings.reminderTime = newTime;
                saveData();
                showToast(`✅ 提醒時間已設置為 ${newTime}`);
            } else if (newTime) {
                showToast('❌ 時間格式錯誤，請使用 HH:MM 格式');
            }
        }
        
        // 📊 數據統計
        function openDataStats() {
            const stats = calculateAllStats();
            
            const message = `📊 數據統計\n\n` +
                          `📝 總任務數：${stats.totalTasks} 個\n` +
                          `✅ 已完成任務：${stats.completedTasks} 個\n` +
                          `📈 完成率：${stats.taskCompletionRate}%\n\n` +
                          `🎯 年度目標：${stats.totalGoals} 個\n` +
                          `✨ 已達成：${stats.completedGoals} 個\n` +
                          `📈 達成率：${stats.goalCompletionRate}%\n\n` +
                          `🌱 習慣數量：${stats.totalHabits} 個\n` +
                          `🔥 最長連續：${stats.longestStreak} 天\n\n` +
                          `🍅 專注時段：${stats.totalSessions} 個\n` +
                          `⏰ 專注時長：${stats.totalHours} 小時`;
            
            alert(message);
        }
        
        // 計算所有統計數據
        function calculateAllStats() {
            const totalTasks = appData.tasks.length;
            const completedTasks = appData.tasks.filter(t => t.completed).length;
            const taskCompletionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
            
            const totalGoals = appData.goals ? appData.goals.length : 0;
            const completedGoals = appData.goals ? appData.goals.filter(g => g.progress >= 100).length : 0;
            const goalCompletionRate = totalGoals > 0 ? Math.round((completedGoals / totalGoals) * 100) : 0;
            
            const totalHabits = appData.habits.length;
            const longestStreak = totalHabits > 0 ? Math.max(...appData.habits.map(h => h.streak)) : 0;
            
            const totalSessions = appData.focusSessions.length;
            const totalMinutes = appData.focusSessions.reduce((sum, s) => sum + s.duration, 0);
            const totalHours = (totalMinutes / 60).toFixed(1);
            
            return {
                totalTasks,
                completedTasks,
                taskCompletionRate,
                totalGoals,
                completedGoals,
                goalCompletionRate,
                totalHabits,
                longestStreak,
                totalSessions,
                totalHours
            };
        }
        
        // ☁️ 雲端同步
        function syncToCloud() {
            showToast('🔄 正在同步到雲端...', 'info');
            
            // 模擬雲端同步
            setTimeout(() => {
                showToast('✅ 數據已同步到雲端！', 'success');
            }, 2000);
            
            // 實際應用中，這裡會調用雲端 API
            // 例如：Firebase、AWS、自建服務器等
        }
        
        // 💾 備份與還原
        function openBackupRestore() {
            const choice = confirm('備份與還原\n\n點擊「確定」備份數據\n點擊「取消」還原數據');
            
            if (choice) {
                // 備份數據
                backupData();
            } else {
                // 還原數據
                restoreData();
            }
        }
        
        // 備份數據
        function backupData() {
            try {
                const backupData = JSON.stringify(appData, null, 2);
                const blob = new Blob([backupData], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                const timestamp = new Date().toISOString().slice(0, 10);
                a.href = url;
                a.download = `orbit-backup-${timestamp}.json`;
                a.click();
                URL.revokeObjectURL(url);
                showToast('✅ 數據已備份到文件！');
            } catch (error) {
                showToast('❌ 備份失敗：' + error.message);
            }
        }
        
        // 還原數據
        function restoreData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const restoredData = JSON.parse(event.target.result);
                            
                            if (confirm('確定要還原數據嗎？當前數據將被覆蓋！')) {
                                appData = restoredData;
                                saveData();
                                showToast('✅ 數據已還原！');
                                
                                // 重新渲染所有界面
                                setTimeout(() => {
                                    location.reload();
                                }, 1000);
                            }
                        } catch (error) {
                            showToast('❌ 還原失敗：文件格式錯誤');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }
        
        // 📤 導出數據
        function exportData() {
            const format = confirm('選擇導出格式\n\n點擊「確定」導出為 JSON\n點擊「取消」導出為 CSV');
            
            if (format) {
                exportAsJSON();
            } else {
                exportAsCSV();
            }
        }
        
        // 導出為 JSON
        function exportAsJSON() {
            try {
                const exportData = {
                    exportDate: new Date().toISOString(),
                    version: '1.0',
                    data: appData
                };
                
                const jsonStr = JSON.stringify(exportData, null, 2);
                const blob = new Blob([jsonStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                const timestamp = new Date().toISOString().slice(0, 10);
                a.href = url;
                a.download = `orbit-data-${timestamp}.json`;
                a.click();
                URL.revokeObjectURL(url);
                showToast('✅ 數據已導出為 JSON！');
            } catch (error) {
                showToast('❌ 導出失敗：' + error.message);
            }
        }
        
        // 導出為 CSV
        function exportAsCSV() {
            try {
                // 導出任務列表為 CSV
                let csv = 'ID,標題,時間,狀態,優先級,日期\n';
                appData.tasks.forEach(task => {
                    csv += `${task.id},"${task.title}","${task.time}",${task.completed ? '已完成' : '未完成'},${task.priority},"${task.date}"\n`;
                });
                
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                const timestamp = new Date().toISOString().slice(0, 10);
                a.href = url;
                a.download = `orbit-tasks-${timestamp}.csv`;
                a.click();
                URL.revokeObjectURL(url);
                showToast('✅ 任務數據已導出為 CSV！');
            } catch (error) {
                showToast('❌ 導出失敗：' + error.message);
            }
        }

        // ==================== 關於頁面 ====================
        
        // ℹ️ 關於 Orbit
        function openAboutOrbit() {
            const message = `
🌲 Orbit 時間管理應用
━━━━━━━━━━━━━━━━━━━━

📱 應用名稱：Orbit Time Manager
🔖 版本號：v1.0.0
📅 發布日期：2024年12月

━━━━━━━━━━━━━━━━━━━━

💡 功能特色：

✅ 智能任務管理
   • 快速創建和追蹤日常任務
   • 多優先級任務分類
   • 任務完成狀態追蹤

🌱 習慣養成系統
   • 每日習慣打卡
   • 連續天數記錄
   • 視覺化進度追蹤

🎯 年度目標追蹤
   • 長期目標設定
   • 進度百分比顯示
   • 多維度分類管理

🍅 番茄鐘專注計時
   • 25分鐘專注時段
   • 休息時間提醒
   • 專注記錄統計

📊 數據統計分析
   • 任務完成率統計
   • 習慣養成分析
   • 時間使用報告

━━━━━━━━━━━━━━━━━━━━

🎨 設計理念：
溫暖的木質調風格，營造舒適自然的
使用體驗，讓時間管理變得更加愉悅

━━━━━━━━━━━━━━━━━━━━

👨‍💻 開發團隊：Orbit Dev Team
📧 聯繫郵箱：support@orbit-app.com
🌐 官方網站：www.orbit-app.com

感謝您使用 Orbit！
讓我們一起創造更高效的生活 ✨
            `.trim();
            
            alert(message);
            showToast('感謝使用 Orbit ✨');
        }
        
        // 📝 使用條款
        function openTermsOfService() {
            const message = `
📝 Orbit 使用條款
━━━━━━━━━━━━━━━━━━━━

最後更新日期：2024年12月

歡迎使用 Orbit 時間管理應用！

1️⃣ 服務條款接受

使用本應用即表示您同意遵守以下條款。
如果您不同意這些條款，請停止使用本應用。

2️⃣ 服務內容

Orbit 提供以下服務：
• 個人任務管理功能
• 習慣養成追蹤系統
• 年度目標設定工具
• 番茄鐘專注計時器
• 數據統計和分析功能

3️⃣ 用戶責任

您承諾：
• 提供真實、準確的個人信息
• 不將本應用用於非法目的
• 不干擾或破壞應用正常運行
• 對您的帳戶安全負責

4️⃣ 知識產權

本應用的所有內容，包括但不限於：
• 軟件代碼和設計
• 圖標、界面和佈局
• 文字、圖片和音頻

均受版權法保護。未經授權，不得複製、
修改、分發或用於商業目的。

5️⃣ 免責聲明

• 本應用按「現狀」提供服務
• 不保證服務不中斷或無錯誤
• 對因使用本應用造成的損失不承擔責任
• 保留隨時修改或終止服務的權利

6️⃣ 服務變更

我們保留隨時修改本條款的權利。
條款變更後繼續使用本應用，即表示
您接受修改後的條款。

7️⃣ 法律適用

本條款受當地法律管轄。因本條款引起
的爭議，應通過友好協商解決。

8️⃣ 聯繫我們

如有任何疑問，請聯繫：
📧 legal@orbit-app.com
🌐 www.orbit-app.com/terms

感謝您仔細閱讀本使用條款 🙏
            `.trim();
            
            alert(message);
            showToast('請遵守使用條款 📝');
        }
        
        // 🔒 隱私政策
        function openPrivacyPolicy() {
            const message = `
🔒 Orbit 隱私政策
━━━━━━━━━━━━━━━━━━━━

最後更新日期：2024年12月

我們重視並保護您的個人隱私。

1️⃣ 信息收集

我們收集的信息包括：
• 基本個人信息（姓名、郵箱）
• 使用數據（任務、習慣、目標）
• 設備信息（瀏覽器類型、作業系統）
• 使用統計（功能使用頻率）

2️⃣ 信息使用

收集的信息用於：
• 提供和改進應用服務
• 個性化用戶體驗
• 發送重要通知和更新
• 統計分析和功能優化
• 客戶支持服務

3️⃣ 數據存儲

• 數據主要存儲在您的本地設備
• 使用 localStorage 技術保存
• 雲端同步數據採用加密傳輸
• 定期備份確保數據安全

4️⃣ 數據安全

我們採取的安全措施：
• 加密傳輸和存儲
• 定期安全審計
• 訪問權限控制
• 數據備份機制

5️⃣ 第三方服務

本應用可能使用第三方服務：
• 數據分析工具
• 雲端存儲服務
• 通知推送服務

這些服務有各自的隱私政策，
我們建議您仔細閱讀。

6️⃣ 用戶權利

您有權：
• 訪問您的個人數據
• 更正不準確的信息
• 刪除您的賬戶和數據
• 導出您的所有數據
• 拒絕數據處理

7️⃣ Cookie 使用

我們使用 Cookie 和類似技術來：
• 記住您的偏好設置
• 分析應用使用情況
• 提供個性化體驗

您可以通過瀏覽器設置管理 Cookie。

8️⃣ 兒童隱私

本應用不針對13歲以下兒童。
如果我們發現收集了兒童信息，
將立即刪除相關數據。

9️⃣ 政策更新

我們可能會更新本隱私政策。
重大變更將通過應用內通知告知用戶。

🔟 聯繫我們

關於隱私問題，請聯繫：
📧 privacy@orbit-app.com
🌐 www.orbit-app.com/privacy
📞 客服熱線：0800-123-456

您的隱私對我們至關重要 🔐
感謝您的信任！
            `.trim();
            
            alert(message);
            showToast('我們重視您的隱私 🔒');
        }

        // ==================== 動畫效果 ====================
        
        function addHoverAnimations() {
            // 為所有可點擊元素添加 transition
            const clickableElements = document.querySelectorAll('.task-card, .habit-item, .goal-card, .achievement-badge, .stat-card, .setting-item');
            
            clickableElements.forEach(el => {
                el.style.transition = 'all 0.3s ease';
            });
        }

        // ==================== 初始化應用 ====================
        
        // 初始化首頁功能
        function initHomePage() {
            // 為所有"查看全部"按鈕添加點擊事件
            const viewAllButtons = document.querySelectorAll('.section-action');
            viewAllButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    // 切換到待辦頁面（第二個標籤）
                    const screens = document.querySelectorAll('.screen-wrapper');
                    screens.forEach(s => s.classList.remove('active'));
                    if (screens[1]) {
                        screens[1].classList.add('active');
                    }
                    
                    // 更新底部標籤欄狀態
                    const tabItems = document.querySelectorAll('.tab-item');
                    tabItems.forEach(t => t.classList.remove('active'));
                    if (tabItems[1]) {
                        tabItems[1].classList.add('active');
                    }
                    
                    showToast('跳轉到待辦頁面', 'success');
                });
            });
        }
        
        function initApp() {
            console.log('🌲 Orbit 時間管理應用啟動中...');
            
            // 載入數據
            loadData();
            
            // 初始化各個功能
            renderTasks();
            renderHabits();
            renderGoals(); // 渲染年度目標
            renderYearSummary(); // 渲染年度總結
            renderWeekPlan(); // 渲染週計劃
            renderCalendar(); // 渲染月曆
            renderFocusSessions(); // 渲染專注時段記錄
            initTimer();
            initTabBar();
            initCalendarNav(); // 初始化月曆導航
            initSettings();
            initHomePage(); // 初始化首頁功能
            addHoverAnimations();
            
            console.log('✨ 應用初始化完成！');
        }

        // 頁面加載完成後初始化
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initApp);
        } else {
            initApp();
        }

        // 定期保存數據
        setInterval(saveData, 30000); // 每30秒自動保存

        // ==================== PWA 功能 ====================
        
        // 註冊 Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => {
                        console.log('✅ Service Worker 註冊成功:', registration.scope);
                    })
                    .catch(error => {
                        console.log('❌ Service Worker 註冊失敗:', error);
                    });
            });
        }

        // PWA 安裝提示
        let deferredPrompt;
        const installButton = createInstallButton();

        window.addEventListener('beforeinstallprompt', (e) => {
            // 阻止默認的安裝提示
            e.preventDefault();
            deferredPrompt = e;
            
            // 顯示自定義安裝按鈕
            installButton.style.display = 'flex';
            
            console.log('💾 PWA 安裝提示已就緒');
        });

        // 創建安裝按鈕
        function createInstallButton() {
            const button = document.createElement('div');
            button.id = 'installButton';
            button.innerHTML = `
                <div style="
                    position: fixed;
                    bottom: 80px;
                    right: 20px;
                    background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
                    color: white;
                    padding: 12px 20px;
                    border-radius: 25px;
                    box-shadow: 0 4px 15px rgba(139, 69, 19, 0.4);
                    cursor: pointer;
                    display: none;
                    align-items: center;
                    gap: 8px;
                    font-size: 14px;
                    font-weight: 500;
                    z-index: 10000;
                    animation: slideInRight 0.5s ease-out;
                    transition: all 0.3s ease;
                " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                    <i class="fas fa-download"></i>
                    <span>安裝應用</span>
                </div>
            `;
            
            button.addEventListener('click', async () => {
                if (!deferredPrompt) return;
                
                // 顯示安裝提示
                deferredPrompt.prompt();
                
                // 等待用戶響應
                const { outcome } = await deferredPrompt.userChoice;
                
                if (outcome === 'accepted') {
                    console.log('✅ 用戶接受了安裝');
                    showToast('🎉 應用安裝成功！');
                } else {
                    console.log('❌ 用戶取消了安裝');
                }
                
                // 清除提示
                deferredPrompt = null;
                button.style.display = 'none';
            });
            
            document.body.appendChild(button);
            return button;
        }

        // 檢測應用是否已安裝
        window.addEventListener('appinstalled', () => {
            console.log('🎉 Orbit 已成功安裝到設備！');
            showToast('🎉 歡迎使用 Orbit！', 'success');
            deferredPrompt = null;
        });

        // iOS 安裝提示
        function checkiOSInstallPrompt() {
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            const isInStandaloneMode = ('standalone' in window.navigator) && (window.navigator.standalone);
            
            if (isIOS && !isInStandaloneMode) {
                // 檢查是否已經顯示過提示
                const hasSeenPrompt = localStorage.getItem('iosInstallPromptSeen');
                
                if (!hasSeenPrompt) {
                    setTimeout(() => {
                        const shouldShow = confirm(
                            '💡 提示：您可以將 Orbit 添加到主屏幕，享受更好的使用體驗！\n\n' +
                            '操作步驟：\n' +
                            '1. 點擊底部的「分享」按鈕 📤\n' +
                            '2. 選擇「加入主畫面」\n' +
                            '3. 點擊「新增」\n\n' +
                            '是否不再顯示此提示？'
                        );
                        
                        if (shouldShow) {
                            localStorage.setItem('iosInstallPromptSeen', 'true');
                        }
                    }, 3000);
                }
            }
        }

        // 延遲顯示 iOS 安裝提示
        setTimeout(checkiOSInstallPrompt, 5000);

        // 添加滑入動畫
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(150px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
        `;
        document.head.appendChild(style);

    </script>
</body>
</html>